2efd607fc329670a801aed6b7cae9534
'use strict';

var DOCUMENT_MODE = require('./html').DOCUMENT_MODE; //Const


var VALID_DOCTYPE_NAME = 'html',
    QUIRKS_MODE_SYSTEM_ID = 'http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd',
    QUIRKS_MODE_PUBLIC_ID_PREFIXES = ['+//silmaril//dtd html pro v0r11 19970101//en', '-//advasoft ltd//dtd html 3.0 aswedit + extensions//en', '-//as//dtd html 3.0 aswedit + extensions//en', '-//ietf//dtd html 2.0 level 1//en', '-//ietf//dtd html 2.0 level 2//en', '-//ietf//dtd html 2.0 strict level 1//en', '-//ietf//dtd html 2.0 strict level 2//en', '-//ietf//dtd html 2.0 strict//en', '-//ietf//dtd html 2.0//en', '-//ietf//dtd html 2.1e//en', '-//ietf//dtd html 3.0//en', '-//ietf//dtd html 3.0//en//', '-//ietf//dtd html 3.2 final//en', '-//ietf//dtd html 3.2//en', '-//ietf//dtd html 3//en', '-//ietf//dtd html level 0//en', '-//ietf//dtd html level 0//en//2.0', '-//ietf//dtd html level 1//en', '-//ietf//dtd html level 1//en//2.0', '-//ietf//dtd html level 2//en', '-//ietf//dtd html level 2//en//2.0', '-//ietf//dtd html level 3//en', '-//ietf//dtd html level 3//en//3.0', '-//ietf//dtd html strict level 0//en', '-//ietf//dtd html strict level 0//en//2.0', '-//ietf//dtd html strict level 1//en', '-//ietf//dtd html strict level 1//en//2.0', '-//ietf//dtd html strict level 2//en', '-//ietf//dtd html strict level 2//en//2.0', '-//ietf//dtd html strict level 3//en', '-//ietf//dtd html strict level 3//en//3.0', '-//ietf//dtd html strict//en', '-//ietf//dtd html strict//en//2.0', '-//ietf//dtd html strict//en//3.0', '-//ietf//dtd html//en', '-//ietf//dtd html//en//2.0', '-//ietf//dtd html//en//3.0', '-//metrius//dtd metrius presentational//en', '-//microsoft//dtd internet explorer 2.0 html strict//en', '-//microsoft//dtd internet explorer 2.0 html//en', '-//microsoft//dtd internet explorer 2.0 tables//en', '-//microsoft//dtd internet explorer 3.0 html strict//en', '-//microsoft//dtd internet explorer 3.0 html//en', '-//microsoft//dtd internet explorer 3.0 tables//en', '-//netscape comm. corp.//dtd html//en', '-//netscape comm. corp.//dtd strict html//en', '-//o\'reilly and associates//dtd html 2.0//en', '-//o\'reilly and associates//dtd html extended 1.0//en', '-//spyglass//dtd html 2.0 extended//en', '-//sq//dtd html 2.0 hotmetal + extensions//en', '-//sun microsystems corp.//dtd hotjava html//en', '-//sun microsystems corp.//dtd hotjava strict html//en', '-//w3c//dtd html 3 1995-03-24//en', '-//w3c//dtd html 3.2 draft//en', '-//w3c//dtd html 3.2 final//en', '-//w3c//dtd html 3.2//en', '-//w3c//dtd html 3.2s draft//en', '-//w3c//dtd html 4.0 frameset//en', '-//w3c//dtd html 4.0 transitional//en', '-//w3c//dtd html experimental 19960712//en', '-//w3c//dtd html experimental 970421//en', '-//w3c//dtd w3 html//en', '-//w3o//dtd w3 html 3.0//en', '-//w3o//dtd w3 html 3.0//en//', '-//webtechs//dtd mozilla html 2.0//en', '-//webtechs//dtd mozilla html//en'],
    QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES = QUIRKS_MODE_PUBLIC_ID_PREFIXES.concat(['-//w3c//dtd html 4.01 frameset//', '-//w3c//dtd html 4.01 transitional//']),
    QUIRKS_MODE_PUBLIC_IDS = ['-//w3o//dtd w3 html strict 3.0//en//', '-/w3c/dtd html 4.0 transitional/en', 'html'],
    LIMITED_QUIRKS_PUBLIC_ID_PREFIXES = ['-//W3C//DTD XHTML 1.0 Frameset//', '-//W3C//DTD XHTML 1.0 Transitional//'],
    LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES = LIMITED_QUIRKS_PUBLIC_ID_PREFIXES.concat(['-//W3C//DTD HTML 4.01 Frameset//', '-//W3C//DTD HTML 4.01 Transitional//']); //Utils

function enquoteDoctypeId(id) {
  var quote = id.indexOf('"') !== -1 ? '\'' : '"';
  return quote + id + quote;
}

function hasPrefix(publicId, prefixes) {
  for (var i = 0; i < prefixes.length; i++) {
    if (publicId.indexOf(prefixes[i]) === 0) return true;
  }

  return false;
} //API


exports.getDocumentMode = function (name, publicId, systemId) {
  if (name !== VALID_DOCTYPE_NAME) return DOCUMENT_MODE.QUIRKS;
  if (systemId && systemId.toLowerCase() === QUIRKS_MODE_SYSTEM_ID) return DOCUMENT_MODE.QUIRKS;

  if (publicId !== null) {
    publicId = publicId.toLowerCase();
    if (QUIRKS_MODE_PUBLIC_IDS.indexOf(publicId) > -1) return DOCUMENT_MODE.QUIRKS;
    var prefixes = systemId === null ? QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES : QUIRKS_MODE_PUBLIC_ID_PREFIXES;
    if (hasPrefix(publicId, prefixes)) return DOCUMENT_MODE.QUIRKS;
    prefixes = systemId === null ? LIMITED_QUIRKS_PUBLIC_ID_PREFIXES : LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES;
    if (hasPrefix(publicId, prefixes)) return DOCUMENT_MODE.LIMITED_QUIRKS;
  }

  return DOCUMENT_MODE.NO_QUIRKS;
};

exports.serializeContent = function (name, publicId, systemId) {
  var str = '!DOCTYPE ';
  if (name) str += name;
  if (publicId !== null) str += ' PUBLIC ' + enquoteDoctypeId(publicId);else if (systemId !== null) str += ' SYSTEM';
  if (systemId !== null) str += ' ' + enquoteDoctypeId(systemId);
  return str;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRvY3R5cGUuanMiXSwibmFtZXMiOlsiRE9DVU1FTlRfTU9ERSIsInJlcXVpcmUiLCJWQUxJRF9ET0NUWVBFX05BTUUiLCJRVUlSS1NfTU9ERV9TWVNURU1fSUQiLCJRVUlSS1NfTU9ERV9QVUJMSUNfSURfUFJFRklYRVMiLCJRVUlSS1NfTU9ERV9OT19TWVNURU1fSURfUFVCTElDX0lEX1BSRUZJWEVTIiwiY29uY2F0IiwiUVVJUktTX01PREVfUFVCTElDX0lEUyIsIkxJTUlURURfUVVJUktTX1BVQkxJQ19JRF9QUkVGSVhFUyIsIkxJTUlURURfUVVJUktTX1dJVEhfU1lTVEVNX0lEX1BVQkxJQ19JRF9QUkVGSVhFUyIsImVucXVvdGVEb2N0eXBlSWQiLCJpZCIsInF1b3RlIiwiaW5kZXhPZiIsImhhc1ByZWZpeCIsInB1YmxpY0lkIiwicHJlZml4ZXMiLCJpIiwibGVuZ3RoIiwiZXhwb3J0cyIsImdldERvY3VtZW50TW9kZSIsIm5hbWUiLCJzeXN0ZW1JZCIsIlFVSVJLUyIsInRvTG93ZXJDYXNlIiwiTElNSVRFRF9RVUlSS1MiLCJOT19RVUlSS1MiLCJzZXJpYWxpemVDb250ZW50Iiwic3RyIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFJQSxhQUFhLEdBQUdDLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FBa0JELGFBQXRDLEMsQ0FFQTs7O0FBQ0EsSUFBSUUsa0JBQWtCLEdBQUcsTUFBekI7QUFBQSxJQUNJQyxxQkFBcUIsR0FBRyw0REFENUI7QUFBQSxJQUVJQyw4QkFBOEIsR0FBRyxDQUM3Qiw4Q0FENkIsRUFFN0Isd0RBRjZCLEVBRzdCLDhDQUg2QixFQUk3QixtQ0FKNkIsRUFLN0IsbUNBTDZCLEVBTTdCLDBDQU42QixFQU83QiwwQ0FQNkIsRUFRN0Isa0NBUjZCLEVBUzdCLDJCQVQ2QixFQVU3Qiw0QkFWNkIsRUFXN0IsMkJBWDZCLEVBWTdCLDZCQVo2QixFQWE3QixpQ0FiNkIsRUFjN0IsMkJBZDZCLEVBZTdCLHlCQWY2QixFQWdCN0IsK0JB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QUFJakIsc0JBQXNCLENBQUNNLE9BQXZCLENBQStCRSxRQUEvQixJQUEyQyxDQUFDLENBQWhELEVBQ0ksT0FBT2YsYUFBYSxDQUFDdUIsTUFBckI7QUFFSixRQUFJUCxRQUFRLEdBQUdNLFFBQVEsS0FBSyxJQUFiLEdBQW9CakIsMkNBQXBCLEdBQWtFRCw4QkFBakY7QUFFQSxRQUFJVSxTQUFTLENBQUNDLFFBQUQsRUFBV0MsUUFBWCxDQUFiLEVBQ0ksT0FBT2hCLGFBQWEsQ0FBQ3VCLE1BQXJCO0FBRUpQLElBQUFBLFFBQVEsR0FBR00sUUFBUSxLQUFLLElBQWIsR0FBb0JkLGlDQUFwQixHQUF3REMsZ0RBQW5FO0FBRUEsUUFBSUssU0FBUyxDQUFDQyxRQUFELEVBQVdDLFFBQVgsQ0FBYixFQUNJLE9BQU9oQixhQUFhLENBQUN5QixjQUFyQjtBQUNQOztBQUVELFNBQU96QixhQUFhLENBQUMwQixTQUFyQjtBQUNILENBekJEOztBQTJCQVAsT0FBTyxDQUFDUSxnQkFBUixHQUEyQixVQUFVTixJQUFWLEVBQWdCTixRQUFoQixFQUEwQk8sUUFBMUIsRUFBb0M7QUFDM0QsTUFBSU0sR0FBRyxHQUFHLFdBQVY7QUFFQSxNQUFJUCxJQUFKLEVBQ0lPLEdBQUcsSUFBSVAsSUFBUDtBQUVKLE1BQUlOLFFBQVEsS0FBSyxJQUFqQixFQUNJYSxHQUFHLElBQUksYUFBYWxCLGdCQUFnQixDQUFDSyxRQUFELENBQXBDLENBREosS0FHSyxJQUFJTyxRQUFRLEtBQUssSUFBakIsRUFDRE0sR0FBRyxJQUFJLFNBQVA7QUFFSixNQUFJTixRQUFRLEtBQUssSUFBakIsRUFDSU0sR0FBRyxJQUFJLE1BQU1sQixnQkFBZ0IsQ0FBQ1ksUUFBRCxDQUE3QjtBQUVKLFNBQU9NLEdBQVA7QUFDSCxDQWhCRCIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIERPQ1VNRU5UX01PREUgPSByZXF1aXJlKCcuL2h0bWwnKS5ET0NVTUVOVF9NT0RFO1xuXG4vL0NvbnN0XG52YXIgVkFMSURfRE9DVFlQRV9OQU1FID0gJ2h0bWwnLFxuICAgIFFVSVJLU19NT0RFX1NZU1RFTV9JRCA9ICdodHRwOi8vd3d3LmlibS5jb20vZGF0YS9kdGQvdjExL2libXhodG1sMS10cmFuc2l0aW9uYWwuZHRkJyxcbiAgICBRVUlSS1NfTU9ERV9QVUJMSUNfSURfUFJFRklYRVMgPSBbXG4gICAgICAgICcrLy9zaWxtYXJpbC8vZHRkIGh0bWwgcHJvIHYwcjExIDE5OTcwMTAxLy9lbicsXG4gICAgICAgICctLy9hZHZhc29mdCBsdGQvL2R0ZCBodG1sIDMuMCBhc3dlZGl0ICsgZXh0ZW5zaW9ucy8vZW4nLFxuICAgICAgICAnLS8vYXMvL2R0ZCBodG1sIDMuMCBhc3dlZGl0ICsgZXh0ZW5zaW9ucy8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgMi4wIGxldmVsIDEvL2VuJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIDIuMCBsZXZlbCAyLy9lbicsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCAyLjAgc3RyaWN0IGxldmVsIDEvL2VuJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIDIuMCBzdHJpY3QgbGV2ZWwgMi8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgMi4wIHN0cmljdC8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgMi4wLy9lbicsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCAyLjFlLy9lbicsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCAzLjAvL2VuJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIDMuMC8vZW4vLycsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCAzLjIgZmluYWwvL2VuJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIDMuMi8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgMy8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgbGV2ZWwgMC8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgbGV2ZWwgMC8vZW4vLzIuMCcsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCBsZXZlbCAxLy9lbicsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCBsZXZlbCAxLy9lbi8vMi4wJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIGxldmVsIDIvL2VuJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIGxldmVsIDIvL2VuLy8yLjAnLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgbGV2ZWwgMy8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgbGV2ZWwgMy8vZW4vLzMuMCcsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCBzdHJpY3QgbGV2ZWwgMC8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgc3RyaWN0IGxldmVsIDAvL2VuLy8yLjAnLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgc3RyaWN0IGxldmVsIDEvL2VuJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIHN0cmljdCBsZXZlbCAxLy9lbi8vMi4wJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sIHN0cmljdCBsZXZlbCAyLy9lbicsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCBzdHJpY3QgbGV2ZWwgMi8vZW4vLzIuMCcsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCBzdHJpY3QgbGV2ZWwgMy8vZW4nLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgc3RyaWN0IGxldmVsIDMvL2VuLy8zLjAnLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgc3RyaWN0Ly9lbicsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbCBzdHJpY3QvL2VuLy8yLjAnLFxuICAgICAgICAnLS8vaWV0Zi8vZHRkIGh0bWwgc3RyaWN0Ly9lbi8vMy4wJyxcbiAgICAgICAgJy0vL2lldGYvL2R0ZCBodG1sLy9lbicsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbC8vZW4vLzIuMCcsXG4gICAgICAgICctLy9pZXRmLy9kdGQgaHRtbC8vZW4vLzMuMCcsXG4gICAgICAgICctLy9tZXRyaXVzLy9kdGQgbWV0cml1cyBwcmVzZW50YXRpb25hbC8vZW4nLFxuICAgICAgICAnLS8vbWljcm9zb2Z0Ly9kdGQgaW50ZXJuZXQgZXhwbG9yZXIgMi4wIGh0bWwgc3RyaWN0Ly9lbicsXG4gICAgICAgICctLy9taWNyb3NvZnQvL2R0ZCBpbnRlcm5ldCBleHBsb3JlciAyLjAgaHRtbC8vZW4nLFxuICAgICAgICAnLS8vbWljcm9zb2Z0Ly9kdGQgaW50ZXJuZXQgZXhwbG9yZXIgMi4wIHRhYmxlcy8vZW4nLFxuICAgICAgICAnLS8vbWljcm9zb2Z0Ly9kdGQgaW50ZXJuZXQgZXhwbG9yZXIgMy4wIGh0bWwgc3RyaWN0Ly9lbicsXG4gICAgICAgICctLy9taWNyb3NvZnQvL2R0ZCBpbnRlcm5ldCBleHBsb3JlciAzLjAgaHRtbC8vZW4nLFxuICAgICAgICAnLS8vbWljcm9zb2Z0Ly9kdGQgaW50ZXJuZXQgZXhwbG9yZXIgMy4wIHRhYmxlcy8vZW4nLFxuICAgICAgICAnLS8vbmV0c2NhcGUgY29tbS4gY29ycC4vL2R0ZCBodG1sLy9lbicsXG4gICAgICAgICctLy9uZXRzY2FwZSBjb21tLiBjb3JwLi8vZHRkIHN0cmljdCBodG1sLy9lbicsXG4gICAgICAgICctLy9vXFwncmVpbGx5IGFuZCBhc3NvY2lhdGVzLy9kdGQgaHRtbCAyLjAvL2VuJyxcbiAgICAgICAgJy0vL29cXCdyZWlsbHkgYW5kIGFzc29jaWF0ZXMvL2R0ZCBodG1sIGV4dGVuZGVkIDEuMC8vZW4nLFxuICAgICAgICAnLS8vc3B5Z2xhc3MvL2R0ZCBodG1sIDIuMCBleHRlbmRlZC8vZW4nLFxuICAgICAgICAnLS8vc3EvL2R0ZCBodG1sIDIuMCBob3RtZXRhbCArIGV4dGVuc2lvbnMvL2VuJyxcbiAgICAgICAgJy0vL3N1biBtaWNyb3N5c3RlbXMgY29ycC4vL2R0ZCBob3RqYXZhIGh0bWwvL2VuJyxcbiAgICAgICAgJy0vL3N1biBtaWNyb3N5c3RlbXMgY29ycC4vL2R0ZCBob3RqYXZhIHN0cmljdCBodG1sLy9lbicsXG4gICAgICAgICctLy93M2MvL2R0ZCBodG1sIDMgMTk5NS0wMy0yNC8vZW4nLFxuICAgICAgICAnLS8vdzNjLy9kdGQgaHRtbCAzLjIgZHJhZnQvL2VuJyxcbiAgICAgICAgJy0vL3czYy8vZHRkIGh0bWwgMy4yIGZpbmFsLy9lbicsXG4gICAgICAgICctLy93M2MvL2R0ZCBodG1sIDMuMi8vZW4nLFxuICAgICAgICAnLS8vdzNjLy9kdGQgaHRtbCAzLjJzIGRyYWZ0Ly9lbicsXG4gICAgICAgICctLy93M2MvL2R0ZCBodG1sIDQuMCBmcmFtZXNldC8vZW4nLFxuICAgICAgICAnLS8vdzNjLy9kdGQgaHRtbCA0LjAgdHJhbnNpdGlvbmFsLy9lbicsXG4gICAgICAgICctLy93M2MvL2R0ZCBodG1sIGV4cGVyaW1lbnRhbCAxOTk2MDcxMi8vZW4nLFxuICAgICAgICAnLS8vdzNjLy9kdGQgaHRtbCBleHBlcmltZW50YWwgOTcwNDIxLy9lbicsXG4gICAgICAgICctLy93M2MvL2R0ZCB3MyBodG1sLy9lbicsXG4gICAgICAgICctLy93M28vL2R0ZCB3MyBodG1sIDMuMC8vZW4nLFxuICAgICAgICAnLS8vdzNvLy9kdGQgdzMgaHRtbCAzLjAvL2VuLy8nLFxuICAgICAgICAnLS8vd2VidGVjaHMvL2R0ZCBtb3ppbGxhIGh0bWwgMi4wLy9lbicsXG4gICAgICAgICctLy93ZWJ0ZWNocy8vZHRkIG1vemlsbGEgaHRtbC8vZW4nXG4gICAgXSxcbiAgICBRVUlSS1NfTU9ERV9OT19TWVNURU1fSURfUFVCTElDX0lEX1BSRUZJWEVTID0gUVVJUktTX01PREVfUFVCTElDX0lEX1BSRUZJWEVTLmNvbmNhdChbXG4gICAgICAgICctLy93M2MvL2R0ZCBodG1sIDQuMDEgZnJhbWVzZXQvLycsXG4gICAgICAgICctLy93M2MvL2R0ZCBodG1sIDQuMDEgdHJhbnNpdGlvbmFsLy8nXG4gICAgXSksXG4gICAgUVVJUktTX01PREVfUFVCTElDX0lEUyA9IFtcbiAgICAgICAgJy0vL3czby8vZHRkIHczIGh0bWwgc3RyaWN0IDMuMC8vZW4vLycsXG4gICAgICAgICctL3czYy9kdGQgaHRtbCA0LjAgdHJhbnNpdGlvbmFsL2VuJyxcbiAgICAgICAgJ2h0bWwnXG4gICAgXSxcbiAgICBMSU1JVEVEX1FVSVJLU19QVUJMSUNfSURfUFJFRklYRVMgPSBbXG4gICAgICAgICctLy9XM0MvL0RURCBYSFRNTCAxLjAgRnJhbWVzZXQvLycsXG4gICAgICAgICctLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy8nXG4gICAgXSxcbiAgICBMSU1JVEVEX1FVSVJLU19XSVRIX1NZU1RFTV9JRF9QVUJMSUNfSURfUFJFRklYRVMgPSBMSU1JVEVEX1FVSVJLU19QVUJMSUNfSURfUFJFRklYRVMuY29uY2F0KFtcbiAgICAgICAgJy0vL1czQy8vRFREIEhUTUwgNC4wMSBGcmFtZXNldC8vJyxcbiAgICAgICAgJy0vL1czQy8vRFREIEhUTUwgNC4wMSBUcmFuc2l0aW9uYWwvLydcbiAgICBdKTtcblxuXG4vL1V0aWxzXG5mdW5jdGlvbiBlbnF1b3RlRG9jdHlwZUlkKGlkKSB7XG4gICAgdmFyIHF1b3RlID0gaWQuaW5kZXhPZignXCInKSAhPT0gLTEgPyAnXFwnJyA6ICdcIic7XG5cbiAgICByZXR1cm4gcXVvdGUgKyBpZCArIHF1b3RlO1xufVxuXG5mdW5jdGlvbiBoYXNQcmVmaXgocHVibGljSWQsIHByZWZpeGVzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocHVibGljSWQuaW5kZXhPZihwcmVmaXhlc1tpXSkgPT09IDApXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cblxuLy9BUElcbmV4cG9ydHMuZ2V0RG9jdW1lbnRNb2RlID0gZnVuY3Rpb24gKG5hbWUsIHB1YmxpY0lkLCBzeXN0ZW1JZCkge1xuICAgIGlmIChuYW1lICE9PSBWQUxJRF9ET0NUWVBFX05BTUUpXG4gICAgICAgIHJldHVybiBET0NVTUVOVF9NT0RFLlFVSVJLUztcblxuICAgIGlmIChzeXN0ZW1JZCAmJiBzeXN0ZW1JZC50b0xvd2VyQ2FzZSgpID09PSBRVUlSS1NfTU9ERV9TWVNURU1fSUQpXG4gICAgICAgIHJldHVybiBET0NVTUVOVF9NT0RFLlFVSVJLUztcblxuICAgIGlmIChwdWJsaWNJZCAhPT0gbnVsbCkge1xuICAgICAgICBwdWJsaWNJZCA9IHB1YmxpY0lkLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgaWYgKFFVSVJLU19NT0RFX1BVQkxJQ19JRFMuaW5kZXhPZihwdWJsaWNJZCkgPiAtMSlcbiAgICAgICAgICAgIHJldHVybiBET0NVTUVOVF9NT0RFLlFVSVJLUztcblxuICAgICAgICB2YXIgcHJlZml4ZXMgPSBzeXN0ZW1JZCA9PT0gbnVsbCA/IFFVSVJLU19NT0RFX05PX1NZU1RFTV9JRF9QVUJMSUNfSURfUFJFRklYRVMgOiBRVUlSS1NfTU9ERV9QVUJMSUNfSURfUFJFRklYRVM7XG5cbiAgICAgICAgaWYgKGhhc1ByZWZpeChwdWJsaWNJZCwgcHJlZml4ZXMpKVxuICAgICAgICAgICAgcmV0dXJuIERPQ1VNRU5UX01PREUuUVVJUktTO1xuXG4gICAgICAgIHByZWZpeGVzID0gc3lzdGVtSWQgPT09IG51bGwgPyBMSU1JVEVEX1FVSVJLU19QVUJMSUNfSURfUFJFRklYRVMgOiBMSU1JVEVEX1FVSVJLU19XSVRIX1NZU1RFTV9JRF9QVUJMSUNfSURfUFJFRklYRVM7XG5cbiAgICAgICAgaWYgKGhhc1ByZWZpeChwdWJsaWNJZCwgcHJlZml4ZXMpKVxuICAgICAgICAgICAgcmV0dXJuIERPQ1VNRU5UX01PREUuTElNSVRFRF9RVUlSS1M7XG4gICAgfVxuXG4gICAgcmV0dXJuIERPQ1VNRU5UX01PREUuTk9fUVVJUktTO1xufTtcblxuZXhwb3J0cy5zZXJpYWxpemVDb250ZW50ID0gZnVuY3Rpb24gKG5hbWUsIHB1YmxpY0lkLCBzeXN0ZW1JZCkge1xuICAgIHZhciBzdHIgPSAnIURPQ1RZUEUgJztcblxuICAgIGlmIChuYW1lKVxuICAgICAgICBzdHIgKz0gbmFtZTtcblxuICAgIGlmIChwdWJsaWNJZCAhPT0gbnVsbClcbiAgICAgICAgc3RyICs9ICcgUFVCTElDICcgKyBlbnF1b3RlRG9jdHlwZUlkKHB1YmxpY0lkKTtcblxuICAgIGVsc2UgaWYgKHN5c3RlbUlkICE9PSBudWxsKVxuICAgICAgICBzdHIgKz0gJyBTWVNURU0nO1xuXG4gICAgaWYgKHN5c3RlbUlkICE9PSBudWxsKVxuICAgICAgICBzdHIgKz0gJyAnICsgZW5xdW90ZURvY3R5cGVJZChzeXN0ZW1JZCk7XG5cbiAgICByZXR1cm4gc3RyO1xufTtcbiJdfQ==