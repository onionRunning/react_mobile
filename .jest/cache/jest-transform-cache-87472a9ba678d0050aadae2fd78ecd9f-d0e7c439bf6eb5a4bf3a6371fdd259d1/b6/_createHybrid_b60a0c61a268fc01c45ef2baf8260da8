1067191103504437e22bcd00b6464d54
var composeArgs = require('./_composeArgs'),
    composeArgsRight = require('./_composeArgsRight'),
    countHolders = require('./_countHolders'),
    createCtor = require('./_createCtor'),
    createRecurry = require('./_createRecurry'),
    getHolder = require('./_getHolder'),
    reorder = require('./_reorder'),
    replaceHolders = require('./_replaceHolders'),
    root = require('./_root');
/** Used to compose bitmasks for function metadata. */


var WRAP_BIND_FLAG = 1,
    WRAP_BIND_KEY_FLAG = 2,
    WRAP_CURRY_FLAG = 8,
    WRAP_CURRY_RIGHT_FLAG = 16,
    WRAP_ARY_FLAG = 128,
    WRAP_FLIP_FLAG = 512;
/**
 * Creates a function that wraps `func` to invoke it with optional `this`
 * binding of `thisArg`, partial application, and currying.
 *
 * @private
 * @param {Function|string} func The function or method name to wrap.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @param {*} [thisArg] The `this` binding of `func`.
 * @param {Array} [partials] The arguments to prepend to those provided to
 *  the new function.
 * @param {Array} [holders] The `partials` placeholder indexes.
 * @param {Array} [partialsRight] The arguments to append to those provided
 *  to the new function.
 * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.
 * @param {Array} [argPos] The argument positions of the new function.
 * @param {number} [ary] The arity cap of `func`.
 * @param {number} [arity] The arity of `func`.
 * @returns {Function} Returns the new wrapped function.
 */

function createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {
  var isAry = bitmask & WRAP_ARY_FLAG,
      isBind = bitmask & WRAP_BIND_FLAG,
      isBindKey = bitmask & WRAP_BIND_KEY_FLAG,
      isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),
      isFlip = bitmask & WRAP_FLIP_FLAG,
      Ctor = isBindKey ? undefined : createCtor(func);

  function wrapper() {
    var length = arguments.length,
        args = Array(length),
        index = length;

    while (index--) {
      args[index] = arguments[index];
    }

    if (isCurried) {
      var placeholder = getHolder(wrapper),
          holdersCount = countHolders(args, placeholder);
    }

    if (partials) {
      args = composeArgs(args, partials, holders, isCurried);
    }

    if (partialsRight) {
      args = composeArgsRight(args, partialsRight, holdersRight, isCurried);
    }

    length -= holdersCount;

    if (isCurried && length < arity) {
      var newHolders = replaceHolders(args, placeholder);
      return createRecurry(func, bitmask, createHybrid, wrapper.placeholder, thisArg, args, newHolders, argPos, ary, arity - length);
    }

    var thisBinding = isBind ? thisArg : this,
        fn = isBindKey ? thisBinding[func] : func;
    length = args.length;

    if (argPos) {
      args = reorder(args, argPos);
    } else if (isFlip && length > 1) {
      args.reverse();
    }

    if (isAry && ary < length) {
      args.length = ary;
    }

    if (this && this !== root && this instanceof wrapper) {
      fn = Ctor || createCtor(fn);
    }

    return fn.apply(thisBinding, args);
  }

  return wrapper;
}

module.exports = createHybrid;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9jcmVhdGVIeWJyaWQuanMiXSwibmFtZXMiOlsiY29tcG9zZUFyZ3MiLCJyZXF1aXJlIiwiY29tcG9zZUFyZ3NSaWdodCIsImNvdW50SG9sZGVycyIsImNyZWF0ZUN0b3IiLCJjcmVhdGVSZWN1cnJ5IiwiZ2V0SG9sZGVyIiwicmVvcmRlciIsInJlcGxhY2VIb2xkZXJzIiwicm9vdCIsIldSQVBfQklORF9GTEFHIiwiV1JBUF9CSU5EX0tFWV9GTEFHIiwiV1JBUF9DVVJSWV9GTEFHIiwiV1JBUF9DVVJSWV9SSUdIVF9GTEFHIiwiV1JBUF9BUllfRkxBRyIsIldSQVBfRkxJUF9GTEFHIiwiY3JlYXRlSHlicmlkIiwiZnVuYyIsImJpdG1hc2siLCJ0aGlzQXJnIiwicGFydGlhbHMiLCJob2xkZXJzIiwicGFydGlhbHNSaWdodCIsImhvbGRlcnNSaWdodCIsImFyZ1BvcyIsImFyeSIsImFyaXR5IiwiaXNBcnkiLCJpc0JpbmQiLCJpc0JpbmRLZXkiLCJpc0N1cnJpZWQiLCJpc0ZsaXAiLCJDdG9yIiwidW5kZWZpbmVkIiwid3JhcHBlciIsImxlbmd0aCIsImFyZ3VtZW50cyIsImFyZ3MiLCJBcnJheSIsImluZGV4IiwicGxhY2Vob2xkZXIiLCJob2xkZXJzQ291bnQiLCJuZXdIb2xkZXJzIiwidGhpc0JpbmRpbmciLCJmbiIsInJldmVyc2UiLCJhcHBseSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFdBQVcsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQXpCO0FBQUEsSUFDSUMsZ0JBQWdCLEdBQUdELE9BQU8sQ0FBQyxxQkFBRCxDQUQ5QjtBQUFBLElBRUlFLFlBQVksR0FBR0YsT0FBTyxDQUFDLGlCQUFELENBRjFCO0FBQUEsSUFHSUcsVUFBVSxHQUFHSCxPQUFPLENBQUMsZUFBRCxDQUh4QjtBQUFBLElBSUlJLGFBQWEsR0FBR0osT0FBTyxDQUFDLGtCQUFELENBSjNCO0FBQUEsSUFLSUssU0FBUyxHQUFHTCxPQUFPLENB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SUFBQUEsTUFBTSxHQUFHRSxJQUFJLENBQUNGLE1BQWQ7O0FBQ0EsUUFBSVgsTUFBSixFQUFZO0FBQ1ZhLE1BQUFBLElBQUksR0FBRzlCLE9BQU8sQ0FBQzhCLElBQUQsRUFBT2IsTUFBUCxDQUFkO0FBQ0QsS0FGRCxNQUVPLElBQUlPLE1BQU0sSUFBSUksTUFBTSxHQUFHLENBQXZCLEVBQTBCO0FBQy9CRSxNQUFBQSxJQUFJLENBQUNRLE9BQUw7QUFDRDs7QUFDRCxRQUFJbEIsS0FBSyxJQUFJRixHQUFHLEdBQUdVLE1BQW5CLEVBQTJCO0FBQ3pCRSxNQUFBQSxJQUFJLENBQUNGLE1BQUwsR0FBY1YsR0FBZDtBQUNEOztBQUNELFFBQUksUUFBUSxTQUFTaEIsSUFBakIsSUFBeUIsZ0JBQWdCeUIsT0FBN0MsRUFBc0Q7QUFDcERVLE1BQUFBLEVBQUUsR0FBR1osSUFBSSxJQUFJNUIsVUFBVSxDQUFDd0MsRUFBRCxDQUF2QjtBQUNEOztBQUNELFdBQU9BLEVBQUUsQ0FBQ0UsS0FBSCxDQUFTSCxXQUFULEVBQXNCTixJQUF0QixDQUFQO0FBQ0Q7O0FBQ0QsU0FBT0gsT0FBUDtBQUNEOztBQUVEYSxNQUFNLENBQUNDLE9BQVAsR0FBaUJoQyxZQUFqQiIsInNvdXJjZXNDb250ZW50IjpbInZhciBjb21wb3NlQXJncyA9IHJlcXVpcmUoJy4vX2NvbXBvc2VBcmdzJyksXG4gICAgY29tcG9zZUFyZ3NSaWdodCA9IHJlcXVpcmUoJy4vX2NvbXBvc2VBcmdzUmlnaHQnKSxcbiAgICBjb3VudEhvbGRlcnMgPSByZXF1aXJlKCcuL19jb3VudEhvbGRlcnMnKSxcbiAgICBjcmVhdGVDdG9yID0gcmVxdWlyZSgnLi9fY3JlYXRlQ3RvcicpLFxuICAgIGNyZWF0ZVJlY3VycnkgPSByZXF1aXJlKCcuL19jcmVhdGVSZWN1cnJ5JyksXG4gICAgZ2V0SG9sZGVyID0gcmVxdWlyZSgnLi9fZ2V0SG9sZGVyJyksXG4gICAgcmVvcmRlciA9IHJlcXVpcmUoJy4vX3Jlb3JkZXInKSxcbiAgICByZXBsYWNlSG9sZGVycyA9IHJlcXVpcmUoJy4vX3JlcGxhY2VIb2xkZXJzJyksXG4gICAgcm9vdCA9IHJlcXVpcmUoJy4vX3Jvb3QnKTtcblxuLyoqIFVzZWQgdG8gY29tcG9zZSBiaXRtYXNrcyBmb3IgZnVuY3Rpb24gbWV0YWRhdGEuICovXG52YXIgV1JBUF9CSU5EX0ZMQUcgPSAxLFxuICAgIFdSQVBfQklORF9LRVlfRkxBRyA9IDIsXG4gICAgV1JBUF9DVVJSWV9GTEFHID0gOCxcbiAgICBXUkFQX0NVUlJZX1JJR0hUX0ZMQUcgPSAxNixcbiAgICBXUkFQX0FSWV9GTEFHID0gMTI4LFxuICAgIFdSQVBfRkxJUF9GTEFHID0gNTEyO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdyYXBzIGBmdW5jYCB0byBpbnZva2UgaXQgd2l0aCBvcHRpb25hbCBgdGhpc2BcbiAqIGJpbmRpbmcgb2YgYHRoaXNBcmdgLCBwYXJ0aWFsIGFwcGxpY2F0aW9uLCBhbmQgY3VycnlpbmcuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7RnVuY3Rpb258c3RyaW5nfSBmdW5jIFRoZSBmdW5jdGlvbiBvciBtZXRob2QgbmFtZSB0byB3cmFwLlxuICogQHBhcmFtIHtudW1iZXJ9IGJpdG1hc2sgVGhlIGJpdG1hc2sgZmxhZ3MuIFNlZSBgY3JlYXRlV3JhcGAgZm9yIG1vcmUgZGV0YWlscy5cbiAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgZnVuY2AuXG4gKiBAcGFyYW0ge0FycmF5fSBbcGFydGlhbHNdIFRoZSBhcmd1bWVudHMgdG8gcHJlcGVuZCB0byB0aG9zZSBwcm92aWRlZCB0b1xuICogIHRoZSBuZXcgZnVuY3Rpb24uXG4gKiBAcGFyYW0ge0FycmF5fSBbaG9sZGVyc10gVGhlIGBwYXJ0aWFsc2AgcGxhY2Vob2xkZXIgaW5kZXhlcy5cbiAqIEBwYXJhbSB7QXJyYXl9IFtwYXJ0aWFsc1JpZ2h0XSBUaGUgYXJndW1lbnRzIHRvIGFwcGVuZCB0byB0aG9zZSBwcm92aWRlZFxuICogIHRvIHRoZSBuZXcgZnVuY3Rpb24uXG4gKiBAcGFyYW0ge0FycmF5fSBbaG9sZGVyc1JpZ2h0XSBUaGUgYHBhcnRpYWxzUmlnaHRgIHBsYWNlaG9sZGVyIGluZGV4ZXMuXG4gKiBAcGFyYW0ge0FycmF5fSBbYXJnUG9zXSBUaGUgYXJndW1lbnQgcG9zaXRpb25zIG9mIHRoZSBuZXcgZnVuY3Rpb24uXG4gKiBAcGFyYW0ge251bWJlcn0gW2FyeV0gVGhlIGFyaXR5IGNhcCBvZiBgZnVuY2AuXG4gKiBAcGFyYW0ge251bWJlcn0gW2FyaXR5XSBUaGUgYXJpdHkgb2YgYGZ1bmNgLlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgd3JhcHBlZCBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gY3JlYXRlSHlicmlkKGZ1bmMsIGJpdG1hc2ssIHRoaXNBcmcsIHBhcnRpYWxzLCBob2xkZXJzLCBwYXJ0aWFsc1JpZ2h0LCBob2xkZXJzUmlnaHQsIGFyZ1BvcywgYXJ5LCBhcml0eSkge1xuICB2YXIgaXNBcnkgPSBiaXRtYXNrICYgV1JBUF9BUllfRkxBRyxcbiAgICAgIGlzQmluZCA9IGJpdG1hc2sgJiBXUkFQX0JJTkRfRkxBRyxcbiAgICAgIGlzQmluZEtleSA9IGJpdG1hc2sgJiBXUkFQX0JJTkRfS0VZX0ZMQUcsXG4gICAgICBpc0N1cnJpZWQgPSBiaXRtYXNrICYgKFdSQVBfQ1VSUllfRkxBRyB8IFdSQVBfQ1VSUllfUklHSFRfRkxBRyksXG4gICAgICBpc0ZsaXAgPSBiaXRtYXNrICYgV1JBUF9GTElQX0ZMQUcsXG4gICAgICBDdG9yID0gaXNCaW5kS2V5ID8gdW5kZWZpbmVkIDogY3JlYXRlQ3RvcihmdW5jKTtcblxuICBmdW5jdGlvbiB3cmFwcGVyKCkge1xuICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoLFxuICAgICAgICBhcmdzID0gQXJyYXkobGVuZ3RoKSxcbiAgICAgICAgaW5kZXggPSBsZW5ndGg7XG5cbiAgICB3aGlsZSAoaW5kZXgtLSkge1xuICAgICAgYXJnc1tpbmRleF0gPSBhcmd1bWVudHNbaW5kZXhdO1xuICAgIH1cbiAgICBpZiAoaXNDdXJyaWVkKSB7XG4gICAgICB2YXIgcGxhY2Vob2xkZXIgPSBnZXRIb2xkZXIod3JhcHBlciksXG4gICAgICAgICAgaG9sZGVyc0NvdW50ID0gY291bnRIb2xkZXJzKGFyZ3MsIHBsYWNlaG9sZGVyKTtcbiAgICB9XG4gICAgaWYgKHBhcnRpYWxzKSB7XG4gICAgICBhcmdzID0gY29tcG9zZUFyZ3MoYXJncywgcGFydGlhbHMsIGhvbGRlcnMsIGlzQ3VycmllZCk7XG4gICAgfVxuICAgIGlmIChwYXJ0aWFsc1JpZ2h0KSB7XG4gICAgICBhcmdzID0gY29tcG9zZUFyZ3NSaWdodChhcmdzLCBwYXJ0aWFsc1JpZ2h0LCBob2xkZXJzUmlnaHQsIGlzQ3VycmllZCk7XG4gICAgfVxuICAgIGxlbmd0aCAtPSBob2xkZXJzQ291bnQ7XG4gICAgaWYgKGlzQ3VycmllZCAmJiBsZW5ndGggPCBhcml0eSkge1xuICAgICAgdmFyIG5ld0hvbGRlcnMgPSByZXBsYWNlSG9sZGVycyhhcmdzLCBwbGFjZWhvbGRlcik7XG4gICAgICByZXR1cm4gY3JlYXRlUmVjdXJyeShcbiAgICAgICAgZnVuYywgYml0bWFzaywgY3JlYXRlSHlicmlkLCB3cmFwcGVyLnBsYWNlaG9sZGVyLCB0aGlzQXJnLFxuICAgICAgICBhcmdzLCBuZXdIb2xkZXJzLCBhcmdQb3MsIGFyeSwgYXJpdHkgLSBsZW5ndGhcbiAgICAgICk7XG4gICAgfVxuICAgIHZhciB0aGlzQmluZGluZyA9IGlzQmluZCA/IHRoaXNBcmcgOiB0aGlzLFxuICAgICAgICBmbiA9IGlzQmluZEtleSA/IHRoaXNCaW5kaW5nW2Z1bmNdIDogZnVuYztcblxuICAgIGxlbmd0aCA9IGFyZ3MubGVuZ3RoO1xuICAgIGlmIChhcmdQb3MpIHtcbiAgICAgIGFyZ3MgPSByZW9yZGVyKGFyZ3MsIGFyZ1Bvcyk7XG4gICAgfSBlbHNlIGlmIChpc0ZsaXAgJiYgbGVuZ3RoID4gMSkge1xuICAgICAgYXJncy5yZXZlcnNlKCk7XG4gICAgfVxuICAgIGlmIChpc0FyeSAmJiBhcnkgPCBsZW5ndGgpIHtcbiAgICAgIGFyZ3MubGVuZ3RoID0gYXJ5O1xuICAgIH1cbiAgICBpZiAodGhpcyAmJiB0aGlzICE9PSByb290ICYmIHRoaXMgaW5zdGFuY2VvZiB3cmFwcGVyKSB7XG4gICAgICBmbiA9IEN0b3IgfHwgY3JlYXRlQ3Rvcihmbik7XG4gICAgfVxuICAgIHJldHVybiBmbi5hcHBseSh0aGlzQmluZGluZywgYXJncyk7XG4gIH1cbiAgcmV0dXJuIHdyYXBwZXI7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlSHlicmlkO1xuIl19