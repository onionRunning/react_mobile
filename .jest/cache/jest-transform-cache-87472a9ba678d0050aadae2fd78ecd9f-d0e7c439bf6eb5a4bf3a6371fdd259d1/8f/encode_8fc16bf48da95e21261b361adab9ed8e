77e7847285c20b7929ad6a26148a9e43
"use strict";

var __importDefault = this && this.__importDefault || function (mod) {
  return mod && mod.__esModule ? mod : {
    "default": mod
  };
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

var xml_json_1 = __importDefault(require("./maps/xml.json"));

var inverseXML = getInverseObj(xml_json_1.default);
var xmlReplacer = getInverseReplacer(inverseXML);
exports.encodeXML = getInverse(inverseXML, xmlReplacer);

var entities_json_1 = __importDefault(require("./maps/entities.json"));

var inverseHTML = getInverseObj(entities_json_1.default);
var htmlReplacer = getInverseReplacer(inverseHTML);
exports.encodeHTML = getInverse(inverseHTML, htmlReplacer);

function getInverseObj(obj) {
  return Object.keys(obj).sort().reduce(function (inverse, name) {
    inverse[obj[name]] = "&" + name + ";";
    return inverse;
  }, {});
}

function getInverseReplacer(inverse) {
  var single = [];
  var multiple = [];

  for (var _i = 0, _a = Object.keys(inverse); _i < _a.length; _i++) {
    var k = _a[_i];

    if (k.length === 1) {
      // Add value to single array
      single.push("\\" + k);
    } else {
      // Add value to multiple array
      multiple.push(k);
    }
  } // Add ranges to single characters.


  single.sort();

  for (var start = 0; start < single.length - 1; start++) {
    // Find the end of a run of characters
    var end = start;

    while (end < single.length - 1 && single[end].charCodeAt(1) + 1 === single[end + 1].charCodeAt(1)) {
      end += 1;
    }

    var count = 1 + end - start; // We want to replace at least three characters

    if (count < 3) continue;
    single.splice(start, count, single[start] + "-" + single[end]);
  }

  multiple.unshift("[" + single.join("") + "]");
  return new RegExp(multiple.join("|"), "g");
}

var reNonASCII = /[^\0-\x7F]/gu;

function singleCharReplacer(c) {
  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
  return "&#x" + c.codePointAt(0).toString(16).toUpperCase() + ";";
}

function getInverse(inverse, re) {
  return function (data) {
    return data.replace(re, function (name) {
      return inverse[name];
    }).replace(reNonASCII, singleCharReplacer);
  };
}

var reXmlChars = getInverseReplacer(inverseXML);

function escape(data) {
  return data.replace(reXmlChars, singleCharReplacer).replace(reNonASCII, singleCharReplacer);
}

exports.escape = escape;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuY29kZS5qcyJdLCJuYW1lcyI6WyJfX2ltcG9ydERlZmF1bHQiLCJtb2QiLCJfX2VzTW9kdWxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJ4bWxfanNvbl8xIiwicmVxdWlyZSIsImludmVyc2VYTUwiLCJnZXRJbnZlcnNlT2JqIiwiZGVmYXVsdCIsInhtbFJlcGxhY2VyIiwiZ2V0SW52ZXJzZVJlcGxhY2VyIiwiZW5jb2RlWE1MIiwiZ2V0SW52ZXJzZSIsImVudGl0aWVzX2pzb25fMSIsImludmVyc2VIVE1MIiwiaHRtbFJlcGxhY2VyIiwiZW5jb2RlSFRNTCIsIm9iaiIsImtleXMiLCJzb3J0IiwicmVkdWNlIiwiaW52ZXJzZSIsIm5hbWUiLCJzaW5nbGUiLCJtdWx0aXBsZSIsIl9pIiwiX2EiLCJsZW5ndGgiLCJrIiwicHVzaCIsInN0YXJ0IiwiZW5kIiwiY2hhckNvZGVBdCIsImNvdW50Iiwic3BsaWNlIiwidW5zaGlmdCIsImpvaW4iLCJSZWdFeHAiLCJyZU5vbkFTQ0lJIiwic2luZ2xlQ2hhclJlcGxhY2VyIiwiYyIsImNvZGVQb2ludEF0IiwidG9TdHJpbmciLCJ0b1VwcGVyQ2FzZSIsInJlIiwiZGF0YSIsInJlcGxhY2UiLCJyZVhtbENoYXJzIiwiZXNjYXBlIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFDQSxJQUFJQSxlQUFlLEdBQUksUUFBUSxLQUFLQSxlQUFkLElBQWtDLFVBQVVDLEdBQVYsRUFBZTtBQUNuRSxTQUFRQSxHQUFHLElBQUlBLEdBQUcsQ0FBQ0MsVUFBWixHQUEwQkQsR0FBMUIsR0FBZ0M7QUFBRSxlQUFXQTtBQUFiLEdBQXZDO0FBQ0gsQ0FGRDs7QUFHQUUsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztBQUFFQyxFQUFBQSxLQUFLLEVBQUU7QUFBVCxDQUE3Qzs7QUFDQSxJQUFJQyxVQUFVLEdBQUdQLGVBQWUsQ0FBQ1EsT0FBTyxDQUFDLGlCQUFE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O0FBQ0EsU0FBTyxJQUFJQyxNQUFKLENBQVdiLFFBQVEsQ0FBQ1ksSUFBVCxDQUFjLEdBQWQsQ0FBWCxFQUErQixHQUEvQixDQUFQO0FBQ0g7O0FBQ0QsSUFBSUUsVUFBVSxHQUFHLGNBQWpCOztBQUNBLFNBQVNDLGtCQUFULENBQTRCQyxDQUE1QixFQUErQjtBQUMzQjtBQUNBLFNBQU8sUUFBUUEsQ0FBQyxDQUFDQyxXQUFGLENBQWMsQ0FBZCxFQUFpQkMsUUFBakIsQ0FBMEIsRUFBMUIsRUFBOEJDLFdBQTlCLEVBQVIsR0FBc0QsR0FBN0Q7QUFDSDs7QUFDRCxTQUFTL0IsVUFBVCxDQUFvQlMsT0FBcEIsRUFBNkJ1QixFQUE3QixFQUFpQztBQUM3QixTQUFPLFVBQVVDLElBQVYsRUFBZ0I7QUFDbkIsV0FBT0EsSUFBSSxDQUNOQyxPQURFLENBQ01GLEVBRE4sRUFDVSxVQUFVdEIsSUFBVixFQUFnQjtBQUFFLGFBQU9ELE9BQU8sQ0FBQ0MsSUFBRCxDQUFkO0FBQXVCLEtBRG5ELEVBRUZ3QixPQUZFLENBRU1SLFVBRk4sRUFFa0JDLGtCQUZsQixDQUFQO0FBR0gsR0FKRDtBQUtIOztBQUNELElBQUlRLFVBQVUsR0FBR3JDLGtCQUFrQixDQUFDSixVQUFELENBQW5DOztBQUNBLFNBQVMwQyxNQUFULENBQWdCSCxJQUFoQixFQUFzQjtBQUNsQixTQUFPQSxJQUFJLENBQ05DLE9BREUsQ0FDTUMsVUFETixFQUNrQlIsa0JBRGxCLEVBRUZPLE9BRkUsQ0FFTVIsVUFGTixFQUVrQkMsa0JBRmxCLENBQVA7QUFHSDs7QUFDRHJDLE9BQU8sQ0FBQzhDLE1BQVIsR0FBaUJBLE1BQWpCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgeG1sX2pzb25fMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9tYXBzL3htbC5qc29uXCIpKTtcbnZhciBpbnZlcnNlWE1MID0gZ2V0SW52ZXJzZU9iaih4bWxfanNvbl8xLmRlZmF1bHQpO1xudmFyIHhtbFJlcGxhY2VyID0gZ2V0SW52ZXJzZVJlcGxhY2VyKGludmVyc2VYTUwpO1xuZXhwb3J0cy5lbmNvZGVYTUwgPSBnZXRJbnZlcnNlKGludmVyc2VYTUwsIHhtbFJlcGxhY2VyKTtcbnZhciBlbnRpdGllc19qc29uXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vbWFwcy9lbnRpdGllcy5qc29uXCIpKTtcbnZhciBpbnZlcnNlSFRNTCA9IGdldEludmVyc2VPYmooZW50aXRpZXNfanNvbl8xLmRlZmF1bHQpO1xudmFyIGh0bWxSZXBsYWNlciA9IGdldEludmVyc2VSZXBsYWNlcihpbnZlcnNlSFRNTCk7XG5leHBvcnRzLmVuY29kZUhUTUwgPSBnZXRJbnZlcnNlKGludmVyc2VIVE1MLCBodG1sUmVwbGFjZXIpO1xuZnVuY3Rpb24gZ2V0SW52ZXJzZU9iaihvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKVxuICAgICAgICAuc29ydCgpXG4gICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGludmVyc2UsIG5hbWUpIHtcbiAgICAgICAgaW52ZXJzZVtvYmpbbmFtZV1dID0gXCImXCIgKyBuYW1lICsgXCI7XCI7XG4gICAgICAgIHJldHVybiBpbnZlcnNlO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIGdldEludmVyc2VSZXBsYWNlcihpbnZlcnNlKSB7XG4gICAgdmFyIHNpbmdsZSA9IFtdO1xuICAgIHZhciBtdWx0aXBsZSA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBPYmplY3Qua2V5cyhpbnZlcnNlKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGsgPSBfYVtfaV07XG4gICAgICAgIGlmIChrLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgLy8gQWRkIHZhbHVlIHRvIHNpbmdsZSBhcnJheVxuICAgICAgICAgICAgc2luZ2xlLnB1c2goXCJcXFxcXCIgKyBrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIEFkZCB2YWx1ZSB0byBtdWx0aXBsZSBhcnJheVxuICAgICAgICAgICAgbXVsdGlwbGUucHVzaChrKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBBZGQgcmFuZ2VzIHRvIHNpbmdsZSBjaGFyYWN0ZXJzLlxuICAgIHNpbmdsZS5zb3J0KCk7XG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyBzdGFydCA8IHNpbmdsZS5sZW5ndGggLSAxOyBzdGFydCsrKSB7XG4gICAgICAgIC8vIEZpbmQgdGhlIGVuZCBvZiBhIHJ1biBvZiBjaGFyYWN0ZXJzXG4gICAgICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICAgICAgd2hpbGUgKGVuZCA8IHNpbmdsZS5sZW5ndGggLSAxICYmXG4gICAgICAgICAgICBzaW5nbGVbZW5kXS5jaGFyQ29kZUF0KDEpICsgMSA9PT0gc2luZ2xlW2VuZCArIDFdLmNoYXJDb2RlQXQoMSkpIHtcbiAgICAgICAgICAgIGVuZCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb3VudCA9IDEgKyBlbmQgLSBzdGFydDtcbiAgICAgICAgLy8gV2Ugd2FudCB0byByZXBsYWNlIGF0IGxlYXN0IHRocmVlIGNoYXJhY3RlcnNcbiAgICAgICAgaWYgKGNvdW50IDwgMylcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICBzaW5nbGUuc3BsaWNlKHN0YXJ0LCBjb3VudCwgc2luZ2xlW3N0YXJ0XSArIFwiLVwiICsgc2luZ2xlW2VuZF0pO1xuICAgIH1cbiAgICBtdWx0aXBsZS51bnNoaWZ0KFwiW1wiICsgc2luZ2xlLmpvaW4oXCJcIikgKyBcIl1cIik7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAobXVsdGlwbGUuam9pbihcInxcIiksIFwiZ1wiKTtcbn1cbnZhciByZU5vbkFTQ0lJID0gL1teXFwwLVxceDdGXS9ndTtcbmZ1bmN0aW9uIHNpbmdsZUNoYXJSZXBsYWNlcihjKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICByZXR1cm4gXCImI3hcIiArIGMuY29kZVBvaW50QXQoMCkudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCkgKyBcIjtcIjtcbn1cbmZ1bmN0aW9uIGdldEludmVyc2UoaW52ZXJzZSwgcmUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgIC5yZXBsYWNlKHJlLCBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gaW52ZXJzZVtuYW1lXTsgfSlcbiAgICAgICAgICAgIC5yZXBsYWNlKHJlTm9uQVNDSUksIHNpbmdsZUNoYXJSZXBsYWNlcik7XG4gICAgfTtcbn1cbnZhciByZVhtbENoYXJzID0gZ2V0SW52ZXJzZVJlcGxhY2VyKGludmVyc2VYTUwpO1xuZnVuY3Rpb24gZXNjYXBlKGRhdGEpIHtcbiAgICByZXR1cm4gZGF0YVxuICAgICAgICAucmVwbGFjZShyZVhtbENoYXJzLCBzaW5nbGVDaGFyUmVwbGFjZXIpXG4gICAgICAgIC5yZXBsYWNlKHJlTm9uQVNDSUksIHNpbmdsZUNoYXJSZXBsYWNlcik7XG59XG5leHBvcnRzLmVzY2FwZSA9IGVzY2FwZTtcbiJdfQ==