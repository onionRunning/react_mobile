aa247d8342448ac24917fde17cb4c289
var composeArgs = require('./_composeArgs'),
    composeArgsRight = require('./_composeArgsRight'),
    replaceHolders = require('./_replaceHolders');
/** Used as the internal argument placeholder. */


var PLACEHOLDER = '__lodash_placeholder__';
/** Used to compose bitmasks for function metadata. */

var WRAP_BIND_FLAG = 1,
    WRAP_BIND_KEY_FLAG = 2,
    WRAP_CURRY_BOUND_FLAG = 4,
    WRAP_CURRY_FLAG = 8,
    WRAP_ARY_FLAG = 128,
    WRAP_REARG_FLAG = 256;
/* Built-in method references for those with the same name as other `lodash` methods. */

var nativeMin = Math.min;
/**
 * Merges the function metadata of `source` into `data`.
 *
 * Merging metadata reduces the number of wrappers used to invoke a function.
 * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`
 * may be applied regardless of execution order. Methods like `_.ary` and
 * `_.rearg` modify function arguments, making the order in which they are
 * executed important, preventing the merging of metadata. However, we make
 * an exception for a safe combined case where curried functions have `_.ary`
 * and or `_.rearg` applied.
 *
 * @private
 * @param {Array} data The destination metadata.
 * @param {Array} source The source metadata.
 * @returns {Array} Returns `data`.
 */

function mergeData(data, source) {
  var bitmask = data[1],
      srcBitmask = source[1],
      newBitmask = bitmask | srcBitmask,
      isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);
  var isCombo = srcBitmask == WRAP_ARY_FLAG && bitmask == WRAP_CURRY_FLAG || srcBitmask == WRAP_ARY_FLAG && bitmask == WRAP_REARG_FLAG && data[7].length <= source[8] || srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG) && source[7].length <= source[8] && bitmask == WRAP_CURRY_FLAG; // Exit early if metadata can't be merged.

  if (!(isCommon || isCombo)) {
    return data;
  } // Use source `thisArg` if available.


  if (srcBitmask & WRAP_BIND_FLAG) {
    data[2] = source[2]; // Set when currying a bound function.

    newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;
  } // Compose partial arguments.


  var value = source[3];

  if (value) {
    var partials = data[3];
    data[3] = partials ? composeArgs(partials, value, source[4]) : value;
    data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];
  } // Compose partial right arguments.


  value = source[5];

  if (value) {
    partials = data[5];
    data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;
    data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];
  } // Use source `argPos` if available.


  value = source[7];

  if (value) {
    data[7] = value;
  } // Use source `ary` if it's smaller.


  if (srcBitmask & WRAP_ARY_FLAG) {
    data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);
  } // Use source `arity` if one is not provided.


  if (data[9] == null) {
    data[9] = source[9];
  } // Use source `func` and merge bitmasks.


  data[0] = source[0];
  data[1] = newBitmask;
  return data;
}

module.exports = mergeData;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9tZXJnZURhdGEuanMiXSwibmFtZXMiOlsiY29tcG9zZUFyZ3MiLCJyZXF1aXJlIiwiY29tcG9zZUFyZ3NSaWdodCIsInJlcGxhY2VIb2xkZXJzIiwiUExBQ0VIT0xERVIiLCJXUkFQX0JJTkRfRkxBRyIsIldSQVBfQklORF9LRVlfRkxBRyIsIldSQVBfQ1VSUllfQk9VTkRfRkxBRyIsIldSQVBfQ1VSUllfRkxBRyIsIldSQVBfQVJZX0ZMQUciLCJXUkFQX1JFQVJHX0ZMQUciLCJuYXRpdmVNaW4iLCJNYXRoIiwibWluIiwibWVyZ2VEYXRhIiwiZGF0YSIsInNvdXJjZSIsImJpdG1hc2siLCJzcmNCaXRtYXNrIiwibmV3Qml0bWFzayIsImlzQ29tbW9uIiwiaXNDb21ibyIsImxlbmd0aCIsInZhbHVlIiwicGFydGlhbHMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxXQUFXLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUF6QjtBQUFBLElBQ0lDLGdCQUFnQixHQUFHRCxPQUFPLENBQUMscUJBQUQsQ0FEOUI7QUFBQSxJQUVJRSxjQUFjLEdBQUdGLE9BQU8sQ0FBQyxtQkFBRCxDQUY1QjtBQUlBOzs7QUFDQSxJQUFJRyxXQUFXLEdBQUcsd0JBQWxCO0FBRUE7O0FBQ0EsSUFBSUMsY0FBYyxHQUFHLENBQXJCO0FBQUEsSUFDSUMsa0JBQWtCLEdBQUcsQ0FEekI7QUFBQSxJQUVJQyxxQkFBcUIsR0FBRyxDQUY1QjtBQUFBLElBR0lDLGVBQWUsR0FBRyxDQUh0QjtBQUFBLElBSUlDLGFBQWEsR0FBRyxHQUpwQjtBQUFBLElBS0lDLGVBQWUsR0FBRyxHQUx0QjtBQU9BOztBQUNBLElBQUlDLFNBQVMsR0FBR0MsSUFBSSxDQUFDQyxHQUFyQjtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQSxTQUFTQyxTQUFULENBQW1CQyxJQUFuQixFQUF5QkMsTUFBekIsRUFBaUM7QUFDL0IsTUFBSUMsT0FBTyxHQUFHRixJQUFJLENBQUMsQ0FB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QUQsQ0FBTCxFQUFVQyxNQUFNLENBQUMsQ0FBRCxDQUFoQixDQUFqRDtBQUNELEdBM0M4QixDQTRDL0I7OztBQUNBLE1BQUlELElBQUksQ0FBQyxDQUFELENBQUosSUFBVyxJQUFmLEVBQXFCO0FBQ25CQSxJQUFBQSxJQUFJLENBQUMsQ0FBRCxDQUFKLEdBQVVDLE1BQU0sQ0FBQyxDQUFELENBQWhCO0FBQ0QsR0EvQzhCLENBZ0QvQjs7O0FBQ0FELEVBQUFBLElBQUksQ0FBQyxDQUFELENBQUosR0FBVUMsTUFBTSxDQUFDLENBQUQsQ0FBaEI7QUFDQUQsRUFBQUEsSUFBSSxDQUFDLENBQUQsQ0FBSixHQUFVSSxVQUFWO0FBRUEsU0FBT0osSUFBUDtBQUNEOztBQUVEVSxNQUFNLENBQUNDLE9BQVAsR0FBaUJaLFNBQWpCIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGNvbXBvc2VBcmdzID0gcmVxdWlyZSgnLi9fY29tcG9zZUFyZ3MnKSxcbiAgICBjb21wb3NlQXJnc1JpZ2h0ID0gcmVxdWlyZSgnLi9fY29tcG9zZUFyZ3NSaWdodCcpLFxuICAgIHJlcGxhY2VIb2xkZXJzID0gcmVxdWlyZSgnLi9fcmVwbGFjZUhvbGRlcnMnKTtcblxuLyoqIFVzZWQgYXMgdGhlIGludGVybmFsIGFyZ3VtZW50IHBsYWNlaG9sZGVyLiAqL1xudmFyIFBMQUNFSE9MREVSID0gJ19fbG9kYXNoX3BsYWNlaG9sZGVyX18nO1xuXG4vKiogVXNlZCB0byBjb21wb3NlIGJpdG1hc2tzIGZvciBmdW5jdGlvbiBtZXRhZGF0YS4gKi9cbnZhciBXUkFQX0JJTkRfRkxBRyA9IDEsXG4gICAgV1JBUF9CSU5EX0tFWV9GTEFHID0gMixcbiAgICBXUkFQX0NVUlJZX0JPVU5EX0ZMQUcgPSA0LFxuICAgIFdSQVBfQ1VSUllfRkxBRyA9IDgsXG4gICAgV1JBUF9BUllfRkxBRyA9IDEyOCxcbiAgICBXUkFQX1JFQVJHX0ZMQUcgPSAyNTY7XG5cbi8qIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIGZvciB0aG9zZSB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgb3RoZXIgYGxvZGFzaGAgbWV0aG9kcy4gKi9cbnZhciBuYXRpdmVNaW4gPSBNYXRoLm1pbjtcblxuLyoqXG4gKiBNZXJnZXMgdGhlIGZ1bmN0aW9uIG1ldGFkYXRhIG9mIGBzb3VyY2VgIGludG8gYGRhdGFgLlxuICpcbiAqIE1lcmdpbmcgbWV0YWRhdGEgcmVkdWNlcyB0aGUgbnVtYmVyIG9mIHdyYXBwZXJzIHVzZWQgdG8gaW52b2tlIGEgZnVuY3Rpb24uXG4gKiBUaGlzIGlzIHBvc3NpYmxlIGJlY2F1c2UgbWV0aG9kcyBsaWtlIGBfLmJpbmRgLCBgXy5jdXJyeWAsIGFuZCBgXy5wYXJ0aWFsYFxuICogbWF5IGJlIGFwcGxpZWQgcmVnYXJkbGVzcyBvZiBleGVjdXRpb24gb3JkZXIuIE1ldGhvZHMgbGlrZSBgXy5hcnlgIGFuZFxuICogYF8ucmVhcmdgIG1vZGlmeSBmdW5jdGlvbiBhcmd1bWVudHMsIG1ha2luZyB0aGUgb3JkZXIgaW4gd2hpY2ggdGhleSBhcmVcbiAqIGV4ZWN1dGVkIGltcG9ydGFudCwgcHJldmVudGluZyB0aGUgbWVyZ2luZyBvZiBtZXRhZGF0YS4gSG93ZXZlciwgd2UgbWFrZVxuICogYW4gZXhjZXB0aW9uIGZvciBhIHNhZmUgY29tYmluZWQgY2FzZSB3aGVyZSBjdXJyaWVkIGZ1bmN0aW9ucyBoYXZlIGBfLmFyeWBcbiAqIGFuZCBvciBgXy5yZWFyZ2AgYXBwbGllZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtBcnJheX0gZGF0YSBUaGUgZGVzdGluYXRpb24gbWV0YWRhdGEuXG4gKiBAcGFyYW0ge0FycmF5fSBzb3VyY2UgVGhlIHNvdXJjZSBtZXRhZGF0YS5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBgZGF0YWAuXG4gKi9cbmZ1bmN0aW9uIG1lcmdlRGF0YShkYXRhLCBzb3VyY2UpIHtcbiAgdmFyIGJpdG1hc2sgPSBkYXRhWzFdLFxuICAgICAgc3JjQml0bWFzayA9IHNvdXJjZVsxXSxcbiAgICAgIG5ld0JpdG1hc2sgPSBiaXRtYXNrIHwgc3JjQml0bWFzayxcbiAgICAgIGlzQ29tbW9uID0gbmV3Qml0bWFzayA8IChXUkFQX0JJTkRfRkxBRyB8IFdSQVBfQklORF9LRVlfRkxBRyB8IFdSQVBfQVJZX0ZMQUcpO1xuXG4gIHZhciBpc0NvbWJvID1cbiAgICAoKHNyY0JpdG1hc2sgPT0gV1JBUF9BUllfRkxBRykgJiYgKGJpdG1hc2sgPT0gV1JBUF9DVVJSWV9GTEFHKSkgfHxcbiAgICAoKHNyY0JpdG1hc2sgPT0gV1JBUF9BUllfRkxBRykgJiYgKGJpdG1hc2sgPT0gV1JBUF9SRUFSR19GTEFHKSAmJiAoZGF0YVs3XS5sZW5ndGggPD0gc291cmNlWzhdKSkgfHxcbiAgICAoKHNyY0JpdG1hc2sgPT0gKFdSQVBfQVJZX0ZMQUcgfCBXUkFQX1JFQVJHX0ZMQUcpKSAmJiAoc291cmNlWzddLmxlbmd0aCA8PSBzb3VyY2VbOF0pICYmIChiaXRtYXNrID09IFdSQVBfQ1VSUllfRkxBRykpO1xuXG4gIC8vIEV4aXQgZWFybHkgaWYgbWV0YWRhdGEgY2FuJ3QgYmUgbWVyZ2VkLlxuICBpZiAoIShpc0NvbW1vbiB8fCBpc0NvbWJvKSkge1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIC8vIFVzZSBzb3VyY2UgYHRoaXNBcmdgIGlmIGF2YWlsYWJsZS5cbiAgaWYgKHNyY0JpdG1hc2sgJiBXUkFQX0JJTkRfRkxBRykge1xuICAgIGRhdGFbMl0gPSBzb3VyY2VbMl07XG4gICAgLy8gU2V0IHdoZW4gY3VycnlpbmcgYSBib3VuZCBmdW5jdGlvbi5cbiAgICBuZXdCaXRtYXNrIHw9IGJpdG1hc2sgJiBXUkFQX0JJTkRfRkxBRyA/IDAgOiBXUkFQX0NVUlJZX0JPVU5EX0ZMQUc7XG4gIH1cbiAgLy8gQ29tcG9zZSBwYXJ0aWFsIGFyZ3VtZW50cy5cbiAgdmFyIHZhbHVlID0gc291cmNlWzNdO1xuICBpZiAodmFsdWUpIHtcbiAgICB2YXIgcGFydGlhbHMgPSBkYXRhWzNdO1xuICAgIGRhdGFbM10gPSBwYXJ0aWFscyA/IGNvbXBvc2VBcmdzKHBhcnRpYWxzLCB2YWx1ZSwgc291cmNlWzRdKSA6IHZhbHVlO1xuICAgIGRhdGFbNF0gPSBwYXJ0aWFscyA/IHJlcGxhY2VIb2xkZXJzKGRhdGFbM10sIFBMQUNFSE9MREVSKSA6IHNvdXJjZVs0XTtcbiAgfVxuICAvLyBDb21wb3NlIHBhcnRpYWwgcmlnaHQgYXJndW1lbnRzLlxuICB2YWx1ZSA9IHNvdXJjZVs1XTtcbiAgaWYgKHZhbHVlKSB7XG4gICAgcGFydGlhbHMgPSBkYXRhWzVdO1xuICAgIGRhdGFbNV0gPSBwYXJ0aWFscyA/IGNvbXBvc2VBcmdzUmlnaHQocGFydGlhbHMsIHZhbHVlLCBzb3VyY2VbNl0pIDogdmFsdWU7XG4gICAgZGF0YVs2XSA9IHBhcnRpYWxzID8gcmVwbGFjZUhvbGRlcnMoZGF0YVs1XSwgUExBQ0VIT0xERVIpIDogc291cmNlWzZdO1xuICB9XG4gIC8vIFVzZSBzb3VyY2UgYGFyZ1Bvc2AgaWYgYXZhaWxhYmxlLlxuICB2YWx1ZSA9IHNvdXJjZVs3XTtcbiAgaWYgKHZhbHVlKSB7XG4gICAgZGF0YVs3XSA9IHZhbHVlO1xuICB9XG4gIC8vIFVzZSBzb3VyY2UgYGFyeWAgaWYgaXQncyBzbWFsbGVyLlxuICBpZiAoc3JjQml0bWFzayAmIFdSQVBfQVJZX0ZMQUcpIHtcbiAgICBkYXRhWzhdID0gZGF0YVs4XSA9PSBudWxsID8gc291cmNlWzhdIDogbmF0aXZlTWluKGRhdGFbOF0sIHNvdXJjZVs4XSk7XG4gIH1cbiAgLy8gVXNlIHNvdXJjZSBgYXJpdHlgIGlmIG9uZSBpcyBub3QgcHJvdmlkZWQuXG4gIGlmIChkYXRhWzldID09IG51bGwpIHtcbiAgICBkYXRhWzldID0gc291cmNlWzldO1xuICB9XG4gIC8vIFVzZSBzb3VyY2UgYGZ1bmNgIGFuZCBtZXJnZSBiaXRtYXNrcy5cbiAgZGF0YVswXSA9IHNvdXJjZVswXTtcbiAgZGF0YVsxXSA9IG5ld0JpdG1hc2s7XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbWVyZ2VEYXRhO1xuIl19