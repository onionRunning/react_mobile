107959d3d4926b90059dd8a541babce2
/*
  Module dependencies
*/
var ElementType = require('domelementtype');

var entities = require('entities');

var unencodedElements = {
  __proto__: null,
  style: true,
  script: true,
  xmp: true,
  iframe: true,
  noembed: true,
  noframes: true,
  plaintext: true,
  noscript: true
};
/*
  Format attributes
*/

function formatAttrs(attributes, opts) {
  if (!attributes) return;
  var output = '',
      value; // Loop through the attributes

  for (var key in attributes) {
    value = attributes[key];

    if (output) {
      output += ' ';
    }

    output += key;

    if (value !== null && value !== '' || opts.xmlMode) {
      output += '="' + (opts.decodeEntities ? entities.encodeXML(value) : value) + '"';
    }
  }

  return output;
}
/*
  Self-enclosing tags (stolen from node-htmlparser)
*/


var singleTag = {
  __proto__: null,
  area: true,
  base: true,
  basefont: true,
  br: true,
  col: true,
  command: true,
  embed: true,
  frame: true,
  hr: true,
  img: true,
  input: true,
  isindex: true,
  keygen: true,
  link: true,
  meta: true,
  param: true,
  source: true,
  track: true,
  wbr: true
};

var render = module.exports = function (dom, opts) {
  if (!Array.isArray(dom) && !dom.cheerio) dom = [dom];
  opts = opts || {};
  var output = '';

  for (var i = 0; i < dom.length; i++) {
    var elem = dom[i];
    if (elem.type === 'root') output += render(elem.children, opts);else if (ElementType.isTag(elem)) output += renderTag(elem, opts);else if (elem.type === ElementType.Directive) output += renderDirective(elem);else if (elem.type === ElementType.Comment) output += renderComment(elem);else if (elem.type === ElementType.CDATA) output += renderCdata(elem);else output += renderText(elem, opts);
  }

  return output;
};

function renderTag(elem, opts) {
  // Handle SVG
  if (elem.name === "svg") opts = {
    decodeEntities: opts.decodeEntities,
    xmlMode: true
  };
  var tag = '<' + elem.name,
      attribs = formatAttrs(elem.attribs, opts);

  if (attribs) {
    tag += ' ' + attribs;
  }

  if (opts.xmlMode && (!elem.children || elem.children.length === 0)) {
    tag += '/>';
  } else {
    tag += '>';

    if (elem.children) {
      tag += render(elem.children, opts);
    }

    if (!singleTag[elem.name] || opts.xmlMode) {
      tag += '</' + elem.name + '>';
    }
  }

  return tag;
}

function renderDirective(elem) {
  return '<' + elem.data + '>';
}

function renderText(elem, opts) {
  var data = elem.data || ''; // if entities weren't decoded, no need to encode them back

  if (opts.decodeEntities && !(elem.parent && elem.parent.name in unencodedElements)) {
    data = entities.encodeXML(data);
  }

  return data;
}

function renderCdata(elem) {
  return '<![CDATA[' + elem.children[0].data + ']]>';
}

function renderComment(elem) {
  return '<!--' + elem.data + '-->';
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkVsZW1lbnRUeXBlIiwicmVxdWlyZSIsImVudGl0aWVzIiwidW5lbmNvZGVkRWxlbWVudHMiLCJfX3Byb3RvX18iLCJzdHlsZSIsInNjcmlwdCIsInhtcCIsImlmcmFtZSIsIm5vZW1iZWQiLCJub2ZyYW1lcyIsInBsYWludGV4dCIsIm5vc2NyaXB0IiwiZm9ybWF0QXR0cnMiLCJhdHRyaWJ1dGVzIiwib3B0cyIsIm91dHB1dCIsInZhbHVlIiwia2V5IiwieG1sTW9kZSIsImRlY29kZUVudGl0aWVzIiwiZW5jb2RlWE1MIiwic2luZ2xlVGFnIiwiYXJlYSIsImJhc2UiLCJiYXNlZm9udCIsImJyIiwiY29sIiwiY29tbWFuZCIsImVtYmVkIiwiZnJhbWUiLCJociIsImltZyIsImlucHV0IiwiaXNpbmRleCIsImtleWdlbiIsImxpbmsiLCJtZXRhIiwicGFyYW0iLCJzb3VyY2UiLCJ0cmFjayIsIndiciIsInJlbmRlciIsIm1vZHVsZSIsImV4cG9ydHMiLCJkb20iLCJBcnJheSIsImlzQXJyYXkiLCJjaGVlcmlvIiwiaSIsImxlbmd0aCIsImVsZW0iLCJ0eXBlIiwiY2hpbGRyZW4iLCJpc1RhZyIsInJlbmRlclRhZyIsIkRpcmVjdGl2ZSIsInJlbmRlckRpcmVjdGl2ZSIsIkNvbW1lbnQiLCJyZW5kZXJDb21tZW50IiwiQ0RBVEEiLCJyZW5kZXJDZGF0YSIsInJlbmRlclRleHQiLCJuYW1lIiwidGFnIiwiYXR0cmlicyIsImRhdGEiLCJwYXJlbnQiXSwibWFwcGluZ3MiOiJBQUFBOzs7QUFHQSxJQUFJQSxXQUFXLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUF6Qjs7QUFDQSxJQUFJQyxRQUFRLEdBQUdELE9BQU8sQ0FBQyxVQUFELENBQXRCOztBQUVBLElBQUlFLGlCQUFpQixHQUFHO0FBQ3RCQyxFQUFBQSxTQUFTLEVBQUUsSUFEVztBQUV0QkMsRUFBQUEsS0FBSyxFQUFFLElBRmU7QUFHdEJDLEVBQUFBLE1BQU0sRUFB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QWQsRUFBaUJhLElBQS9CLEdBQXNDLEtBQTdDO0FBQ0Q7O0FBRUQsU0FBU1AsYUFBVCxDQUF1QlIsSUFBdkIsRUFBNkI7QUFDM0IsU0FBTyxTQUFTQSxJQUFJLENBQUNlLElBQWQsR0FBcUIsS0FBNUI7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gIE1vZHVsZSBkZXBlbmRlbmNpZXNcbiovXG52YXIgRWxlbWVudFR5cGUgPSByZXF1aXJlKCdkb21lbGVtZW50dHlwZScpO1xudmFyIGVudGl0aWVzID0gcmVxdWlyZSgnZW50aXRpZXMnKTtcblxudmFyIHVuZW5jb2RlZEVsZW1lbnRzID0ge1xuICBfX3Byb3RvX186IG51bGwsXG4gIHN0eWxlOiB0cnVlLFxuICBzY3JpcHQ6IHRydWUsXG4gIHhtcDogdHJ1ZSxcbiAgaWZyYW1lOiB0cnVlLFxuICBub2VtYmVkOiB0cnVlLFxuICBub2ZyYW1lczogdHJ1ZSxcbiAgcGxhaW50ZXh0OiB0cnVlLFxuICBub3NjcmlwdDogdHJ1ZVxufTtcblxuLypcbiAgRm9ybWF0IGF0dHJpYnV0ZXNcbiovXG5mdW5jdGlvbiBmb3JtYXRBdHRycyhhdHRyaWJ1dGVzLCBvcHRzKSB7XG4gIGlmICghYXR0cmlidXRlcykgcmV0dXJuO1xuXG4gIHZhciBvdXRwdXQgPSAnJyxcbiAgICAgIHZhbHVlO1xuXG4gIC8vIExvb3AgdGhyb3VnaCB0aGUgYXR0cmlidXRlc1xuICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgIHZhbHVlID0gYXR0cmlidXRlc1trZXldO1xuICAgIGlmIChvdXRwdXQpIHtcbiAgICAgIG91dHB1dCArPSAnICc7XG4gICAgfVxuXG4gICAgb3V0cHV0ICs9IGtleTtcbiAgICBpZiAoKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSAnJykgfHwgb3B0cy54bWxNb2RlKSB7XG4gICAgICAgIG91dHB1dCArPSAnPVwiJyArIChvcHRzLmRlY29kZUVudGl0aWVzID8gZW50aXRpZXMuZW5jb2RlWE1MKHZhbHVlKSA6IHZhbHVlKSArICdcIic7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxuLypcbiAgU2VsZi1lbmNsb3NpbmcgdGFncyAoc3RvbGVuIGZyb20gbm9kZS1odG1scGFyc2VyKVxuKi9cbnZhciBzaW5nbGVUYWcgPSB7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgYXJlYTogdHJ1ZSxcbiAgYmFzZTogdHJ1ZSxcbiAgYmFzZWZvbnQ6IHRydWUsXG4gIGJyOiB0cnVlLFxuICBjb2w6IHRydWUsXG4gIGNvbW1hbmQ6IHRydWUsXG4gIGVtYmVkOiB0cnVlLFxuICBmcmFtZTogdHJ1ZSxcbiAgaHI6IHRydWUsXG4gIGltZzogdHJ1ZSxcbiAgaW5wdXQ6IHRydWUsXG4gIGlzaW5kZXg6IHRydWUsXG4gIGtleWdlbjogdHJ1ZSxcbiAgbGluazogdHJ1ZSxcbiAgbWV0YTogdHJ1ZSxcbiAgcGFyYW06IHRydWUsXG4gIHNvdXJjZTogdHJ1ZSxcbiAgdHJhY2s6IHRydWUsXG4gIHdicjogdHJ1ZSxcbn07XG5cblxudmFyIHJlbmRlciA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZG9tLCBvcHRzKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShkb20pICYmICFkb20uY2hlZXJpbykgZG9tID0gW2RvbV07XG4gIG9wdHMgPSBvcHRzIHx8IHt9O1xuXG4gIHZhciBvdXRwdXQgPSAnJztcblxuICBmb3IodmFyIGkgPSAwOyBpIDwgZG9tLmxlbmd0aDsgaSsrKXtcbiAgICB2YXIgZWxlbSA9IGRvbVtpXTtcblxuICAgIGlmIChlbGVtLnR5cGUgPT09ICdyb290JylcbiAgICAgIG91dHB1dCArPSByZW5kZXIoZWxlbS5jaGlsZHJlbiwgb3B0cyk7XG4gICAgZWxzZSBpZiAoRWxlbWVudFR5cGUuaXNUYWcoZWxlbSkpXG4gICAgICBvdXRwdXQgKz0gcmVuZGVyVGFnKGVsZW0sIG9wdHMpO1xuICAgIGVsc2UgaWYgKGVsZW0udHlwZSA9PT0gRWxlbWVudFR5cGUuRGlyZWN0aXZlKVxuICAgICAgb3V0cHV0ICs9IHJlbmRlckRpcmVjdGl2ZShlbGVtKTtcbiAgICBlbHNlIGlmIChlbGVtLnR5cGUgPT09IEVsZW1lbnRUeXBlLkNvbW1lbnQpXG4gICAgICBvdXRwdXQgKz0gcmVuZGVyQ29tbWVudChlbGVtKTtcbiAgICBlbHNlIGlmIChlbGVtLnR5cGUgPT09IEVsZW1lbnRUeXBlLkNEQVRBKVxuICAgICAgb3V0cHV0ICs9IHJlbmRlckNkYXRhKGVsZW0pO1xuICAgIGVsc2VcbiAgICAgIG91dHB1dCArPSByZW5kZXJUZXh0KGVsZW0sIG9wdHMpO1xuICB9XG5cbiAgcmV0dXJuIG91dHB1dDtcbn07XG5cbmZ1bmN0aW9uIHJlbmRlclRhZyhlbGVtLCBvcHRzKSB7XG4gIC8vIEhhbmRsZSBTVkdcbiAgaWYgKGVsZW0ubmFtZSA9PT0gXCJzdmdcIikgb3B0cyA9IHtkZWNvZGVFbnRpdGllczogb3B0cy5kZWNvZGVFbnRpdGllcywgeG1sTW9kZTogdHJ1ZX07XG5cbiAgdmFyIHRhZyA9ICc8JyArIGVsZW0ubmFtZSxcbiAgICAgIGF0dHJpYnMgPSBmb3JtYXRBdHRycyhlbGVtLmF0dHJpYnMsIG9wdHMpO1xuXG4gIGlmIChhdHRyaWJzKSB7XG4gICAgdGFnICs9ICcgJyArIGF0dHJpYnM7XG4gIH1cblxuICBpZiAoXG4gICAgb3B0cy54bWxNb2RlXG4gICAgJiYgKCFlbGVtLmNoaWxkcmVuIHx8IGVsZW0uY2hpbGRyZW4ubGVuZ3RoID09PSAwKVxuICApIHtcbiAgICB0YWcgKz0gJy8+JztcbiAgfSBlbHNlIHtcbiAgICB0YWcgKz0gJz4nO1xuICAgIGlmIChlbGVtLmNoaWxkcmVuKSB7XG4gICAgICB0YWcgKz0gcmVuZGVyKGVsZW0uY2hpbGRyZW4sIG9wdHMpO1xuICAgIH1cblxuICAgIGlmICghc2luZ2xlVGFnW2VsZW0ubmFtZV0gfHwgb3B0cy54bWxNb2RlKSB7XG4gICAgICB0YWcgKz0gJzwvJyArIGVsZW0ubmFtZSArICc+JztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGFnO1xufVxuXG5mdW5jdGlvbiByZW5kZXJEaXJlY3RpdmUoZWxlbSkge1xuICByZXR1cm4gJzwnICsgZWxlbS5kYXRhICsgJz4nO1xufVxuXG5mdW5jdGlvbiByZW5kZXJUZXh0KGVsZW0sIG9wdHMpIHtcbiAgdmFyIGRhdGEgPSBlbGVtLmRhdGEgfHwgJyc7XG5cbiAgLy8gaWYgZW50aXRpZXMgd2VyZW4ndCBkZWNvZGVkLCBubyBuZWVkIHRvIGVuY29kZSB0aGVtIGJhY2tcbiAgaWYgKG9wdHMuZGVjb2RlRW50aXRpZXMgJiYgIShlbGVtLnBhcmVudCAmJiBlbGVtLnBhcmVudC5uYW1lIGluIHVuZW5jb2RlZEVsZW1lbnRzKSkge1xuICAgIGRhdGEgPSBlbnRpdGllcy5lbmNvZGVYTUwoZGF0YSk7XG4gIH1cblxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2RhdGEoZWxlbSkge1xuICByZXR1cm4gJzwhW0NEQVRBWycgKyBlbGVtLmNoaWxkcmVuWzBdLmRhdGEgKyAnXV0+Jztcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ29tbWVudChlbGVtKSB7XG4gIHJldHVybiAnPCEtLScgKyBlbGVtLmRhdGEgKyAnLS0+Jztcbn1cbiJdfQ==