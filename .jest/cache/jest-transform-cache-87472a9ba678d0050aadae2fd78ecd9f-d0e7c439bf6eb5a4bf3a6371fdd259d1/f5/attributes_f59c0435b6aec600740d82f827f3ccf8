337c1d3abc6c1c47498a0839816110ff
var $ = require('../static'),
    utils = require('../utils'),
    isTag = utils.isTag,
    domEach = utils.domEach,
    hasOwn = Object.prototype.hasOwnProperty,
    camelCase = utils.camelCase,
    cssCase = utils.cssCase,
    rspace = /\s+/,
    dataAttrPrefix = 'data-',
    _ = {
  forEach: require('lodash/forEach'),
  extend: require('lodash/assignIn'),
  some: require('lodash/some')
},
    // Lookup table for coercing string data-* attributes to their corresponding
// JavaScript primitives
primitives = {
  null: null,
  true: true,
  false: false
},
    // Attributes that are booleans
rboolean = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,
    // Matches strings that look like JSON objects or arrays
rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/;

var getAttr = function (elem, name) {
  if (!elem || !isTag(elem)) return;

  if (!elem.attribs) {
    elem.attribs = {};
  } // Return the entire attribs object if no attribute specified


  if (!name) {
    return elem.attribs;
  }

  if (hasOwn.call(elem.attribs, name)) {
    // Get the (decoded) attribute
    return rboolean.test(name) ? name : elem.attribs[name];
  } // Mimic the DOM and return text content as value for `option's`


  if (elem.name === 'option' && name === 'value') {
    return $.text(elem.children);
  } // Mimic DOM with default value for radios/checkboxes


  if (elem.name === 'input' && (elem.attribs.type === 'radio' || elem.attribs.type === 'checkbox') && name === 'value') {
    return 'on';
  }
};

var setAttr = function (el, name, value) {
  if (value === null) {
    removeAttribute(el, name);
  } else {
    el.attribs[name] = value + '';
  }
};

exports.attr = function (name, value) {
  // Set the value (with attr map support)
  if (typeof name === 'object' || value !== undefined) {
    if (typeof value === 'function') {
      return domEach(this, function (i, el) {
        setAttr(el, name, value.call(el, i, el.attribs[name]));
      });
    }

    return domEach(this, function (i, el) {
      if (!isTag(el)) return;

      if (typeof name === 'object') {
        _.forEach(name, function (objValue, objName) {
          setAttr(el, objName, objValue);
        });
      } else {
        setAttr(el, name, value);
      }
    });
  }

  return getAttr(this[0], name);
};

var getProp = function (el, name) {
  if (!el || !isTag(el)) return;
  return hasOwn.call(el, name) ? el[name] : rboolean.test(name) ? getAttr(el, name) !== undefined : getAttr(el, name);
};

var setProp = function (el, name, value) {
  el[name] = rboolean.test(name) ? !!value : value;
};

exports.prop = function (name, value) {
  var i = 0,
      property;

  if (typeof name === 'string' && value === undefined) {
    switch (name) {
      case 'style':
        property = this.css();

        _.forEach(property, function (v, p) {
          property[i++] = p;
        });

        property.length = i;
        break;

      case 'tagName':
      case 'nodeName':
        property = this[0].name.toUpperCase();
        break;

      default:
        property = getProp(this[0], name);
    }

    return property;
  }

  if (typeof name === 'object' || value !== undefined) {
    if (typeof value === 'function') {
      return domEach(this, function (j, el) {
        setProp(el, name, value.call(el, j, getProp(el, name)));
      });
    }

    return domEach(this, function (__, el) {
      if (!isTag(el)) return;

      if (typeof name === 'object') {
        _.forEach(name, function (val, key) {
          setProp(el, key, val);
        });
      } else {
        setProp(el, name, value);
      }
    });
  }
};

var setData = function (el, name, value) {
  if (!el.data) {
    el.data = {};
  }

  if (typeof name === 'object') return _.extend(el.data, name);

  if (typeof name === 'string' && value !== undefined) {
    el.data[name] = value;
  }
}; // Read the specified attribute from the equivalent HTML5 `data-*` attribute,
// and (if present) cache the value in the node's internal data store. If no
// attribute name is specified, read *all* HTML5 `data-*` attributes in this
// manner.


var readData = function (el, name) {
  var readAll = arguments.length === 1;
  var domNames, domName, jsNames, jsName, value, idx, length;

  if (readAll) {
    domNames = Object.keys(el.attribs).filter(function (attrName) {
      return attrName.slice(0, dataAttrPrefix.length) === dataAttrPrefix;
    });
    jsNames = domNames.map(function (_domName) {
      return camelCase(_domName.slice(dataAttrPrefix.length));
    });
  } else {
    domNames = [dataAttrPrefix + cssCase(name)];
    jsNames = [name];
  }

  for (idx = 0, length = domNames.length; idx < length; ++idx) {
    domName = domNames[idx];
    jsName = jsNames[idx];

    if (hasOwn.call(el.attribs, domName)) {
      value = el.attribs[domName];

      if (hasOwn.call(primitives, value)) {
        value = primitives[value];
      } else if (value === String(Number(value))) {
        value = Number(value);
      } else if (rbrace.test(value)) {
        try {
          value = JSON.parse(value);
        } catch (e) {}
      }

      el.data[jsName] = value;
    }
  }

  return readAll ? el.data : value;
};

exports.data = function (name, value) {
  var elem = this[0];
  if (!elem || !isTag(elem)) return;

  if (!elem.data) {
    elem.data = {};
  } // Return the entire data object if no data specified


  if (!name) {
    return readData(elem);
  } // Set the value (with attr map support)


  if (typeof name === 'object' || value !== undefined) {
    domEach(this, function (i, el) {
      setData(el, name, value);
    });
    return this;
  } else if (hasOwn.call(elem.data, name)) {
    return elem.data[name];
  }

  return readData(elem, name);
};
/**
 * Get the value of an element
 */


exports.val = function (value) {
  var querying = arguments.length === 0,
      element = this[0];
  if (!element) return;

  switch (element.name) {
    case 'textarea':
      return this.text(value);

    case 'input':
      switch (this.attr('type')) {
        case 'radio':
          if (querying) {
            return this.attr('value');
          } else {
            this.attr('value', value);
            return this;
          }

          break;

        default:
          return this.attr('value', value);
      }

      return;

    case 'select':
      var option = this.find('option:selected'),
          returnValue;
      if (option === undefined) return undefined;

      if (!querying) {
        if (!hasOwn.call(this.attr(), 'multiple') && typeof value == 'object') {
          return this;
        }

        if (typeof value != 'object') {
          value = [value];
        }

        this.find('option').removeAttr('selected');

        for (var i = 0; i < value.length; i++) {
          this.find('option[value="' + value[i] + '"]').attr('selected', '');
        }

        return this;
      }

      returnValue = option.attr('value');

      if (hasOwn.call(this.attr(), 'multiple')) {
        returnValue = [];
        domEach(option, function (__, el) {
          returnValue.push(getAttr(el, 'value'));
        });
      }

      return returnValue;

    case 'option':
      if (!querying) {
        this.attr('value', value);
        return this;
      }

      return this.attr('value');
  }
};
/**
 * Remove an attribute
 */


var removeAttribute = function (elem, name) {
  if (!elem.attribs || !hasOwn.call(elem.attribs, name)) return;
  delete elem.attribs[name];
};

exports.removeAttr = function (name) {
  domEach(this, function (i, elem) {
    removeAttribute(elem, name);
  });
  return this;
};

exports.hasClass = function (className) {
  return _.some(this, function (elem) {
    var attrs = elem.attribs,
        clazz = attrs && attrs['class'],
        idx = -1,
        end;

    if (clazz && className.length) {
      while ((idx = clazz.indexOf(className, idx + 1)) > -1) {
        end = idx + className.length;

        if ((idx === 0 || rspace.test(clazz[idx - 1])) && (end === clazz.length || rspace.test(clazz[end]))) {
          return true;
        }
      }
    }
  });
};

exports.addClass = function (value) {
  // Support functions
  if (typeof value === 'function') {
    return domEach(this, function (i, el) {
      var className = el.attribs['class'] || '';
      exports.addClass.call([el], value.call(el, i, className));
    });
  } // Return if no value or not a string or function


  if (!value || typeof value !== 'string') return this;
  var classNames = value.split(rspace),
      numElements = this.length;

  for (var i = 0; i < numElements; i++) {
    // If selected element isn't a tag, move on
    if (!isTag(this[i])) continue; // If we don't already have classes

    var className = getAttr(this[i], 'class'),
        numClasses,
        setClass;

    if (!className) {
      setAttr(this[i], 'class', classNames.join(' ').trim());
    } else {
      setClass = ' ' + className + ' ';
      numClasses = classNames.length; // Check if class already exists

      for (var j = 0; j < numClasses; j++) {
        var appendClass = classNames[j] + ' ';
        if (setClass.indexOf(' ' + appendClass) < 0) setClass += appendClass;
      }

      setAttr(this[i], 'class', setClass.trim());
    }
  }

  return this;
};

var splitClass = function (className) {
  return className ? className.trim().split(rspace) : [];
};

exports.removeClass = function (value) {
  var classes, numClasses, removeAll; // Handle if value is a function

  if (typeof value === 'function') {
    return domEach(this, function (i, el) {
      exports.removeClass.call([el], value.call(el, i, el.attribs['class'] || ''));
    });
  }

  classes = splitClass(value);
  numClasses = classes.length;
  removeAll = arguments.length === 0;
  return domEach(this, function (i, el) {
    if (!isTag(el)) return;

    if (removeAll) {
      // Short circuit the remove all case as this is the nice one
      el.attribs.class = '';
    } else {
      var elClasses = splitClass(el.attribs.class),
          index,
          changed;

      for (var j = 0; j < numClasses; j++) {
        index = elClasses.indexOf(classes[j]);

        if (index >= 0) {
          elClasses.splice(index, 1);
          changed = true; // We have to do another pass to ensure that there are not duplicate
          // classes listed

          j--;
        }
      }

      if (changed) {
        el.attribs.class = elClasses.join(' ');
      }
    }
  });
};

exports.toggleClass = function (value, stateVal) {
  // Support functions
  if (typeof value === 'function') {
    return domEach(this, function (i, el) {
      exports.toggleClass.call([el], value.call(el, i, el.attribs['class'] || '', stateVal), stateVal);
    });
  } // Return if no value or not a string or function


  if (!value || typeof value !== 'string') return this;
  var classNames = value.split(rspace),
      numClasses = classNames.length,
      state = typeof stateVal === 'boolean' ? stateVal ? 1 : -1 : 0,
      numElements = this.length,
      elementClasses,
      index;

  for (var i = 0; i < numElements; i++) {
    // If selected element isn't a tag, move on
    if (!isTag(this[i])) continue;
    elementClasses = splitClass(this[i].attribs.class); // Check if class already exists

    for (var j = 0; j < numClasses; j++) {
      // Check if the class name is currently defined
      index = elementClasses.indexOf(classNames[j]); // Add if stateValue === true or we are toggling and there is no value

      if (state >= 0 && index < 0) {
        elementClasses.push(classNames[j]);
      } else if (state <= 0 && index >= 0) {
        // Otherwise remove but only if the item exists
        elementClasses.splice(index, 1);
      }
    }

    this[i].attribs.class = elementClasses.join(' ');
  }

  return this;
};

exports.is = function (selector) {
  if (selector) {
    return this.filter(selector).length > 0;
  }

  return false;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF0dHJpYnV0ZXMuanMiXSwibmFtZXMiOlsiJCIsInJlcXVpcmUiLCJ1dGlscyIsImlzVGFnIiwiZG9tRWFjaCIsImhhc093biIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FtZWxDYXNlIiwiY3NzQ2FzZSIsInJzcGFjZSIsImRhdGFBdHRyUHJlZml4IiwiXyIsImZvckVhY2giLCJleHRlbmQiLCJzb21lIiwicHJpbWl0aXZlcyIsIm51bGwiLCJ0cnVlIiwiZmFsc2UiLCJyYm9vbGVhbiIsInJicmFjZSIsImdldEF0dHIiLCJlbGVtIiwibmFtZSIsImF0dHJpYnMiLCJjYWxsIiwidGVzdCIsInRleHQiLCJjaGlsZHJlbiIsInR5cGUiLCJzZXRBdHRyIiwiZWwiLCJ2YWx1ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImV4cG9ydHMiLCJhdHRyIiwidW5kZWZpbmVkIiwiaSIsIm9ialZhbHVlIiwib2JqTmFtZSIsImdldFByb3AiLCJzZXRQcm9wIiwicHJvcCIsInByb3BlcnR5IiwiY3NzIiwidiIsInAiLCJsZW5ndGgiLCJ0b1VwcGVyQ2FzZSIsImoiLCJfXyIsInZhbCIsImtleSIsInNldERhdGEiLCJkYXRhIiwicmVhZERhdGEiLCJyZWFkQWxsIiwiYXJndW1lbnRzIiwiZG9tTmFtZXMiLCJkb21OYW1lIiwianNOYW1lcyIsImpzTmFtZSIsImlkeCIsImtleXMiLCJmaWx0ZXIiLCJhdHRyTmFtZSIsInNsaWNlIiwibWFwIiwiX2RvbU5hbWUiLCJTdHJpbmciLCJOdW1iZXIiLCJKU09OIiwicGFyc2UiLCJlIiwicXVlcnlpbmciLCJlbGVtZW50Iiwib3B0aW9uIiwiZmluZCIsInJldHVyblZhbHVlIiwicmVtb3ZlQXR0ciIsInB1c2giLCJoYXNDbGFzcyIsImNsYXNzTmFtZSIsImF0dHJzIiwiY2xhenoiLCJlbmQiLCJpbmRleE9mIiwiYWRkQ2xhc3MiLCJjbGFzc05hbWVzIiwic3BsaXQiLCJudW1FbGVtZW50cyIsIm51bUNsYXNzZXMiLCJzZXRDbGFzcyIsImpvaW4iLCJ0cmltIiwiYXBwZW5kQ2xhc3MiLCJzcGxpdENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJjbGFzc2VzIiwicmVtb3ZlQWxsIiwiY2xhc3MiLCJlbENsYXNzZXMiLCJpbmRleCIsImNoYW5nZWQiLCJzcGxpY2UiLCJ0b2dnbGVDbGFzcyIsInN0YXRlVmFsIiwic3RhdGUiLCJlbGVtZW50Q2xhc3NlcyIsImlzIiwic2VsZWN0b3IiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLENBQUMsR0FBR0MsT0FBTyxDQUFDLFdBQUQsQ0FBZjtBQUFBLElBQ0lDLEtBQUssR0FBR0QsT0FBTyxDQUFDLFVBQUQsQ0FEbkI7QUFBQSxJQUVJRSxLQUFLLEdBQUdELEtBQUssQ0FBQ0MsS0FGbEI7QUFBQSxJQUdJQyxPQUFPLEdBQUdGLEtBQUssQ0FBQ0UsT0FIcEI7QUFBQSxJQUlJQyxNQUFNLEdBQUdDLE1BQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsY0FKOUI7QUFBQSxJQUtJQyxTQUFTLEdBQUdQLEtBQUssQ0FBQ08sU0FMdEI7QUFBQSxJQU1JQyxPQUFPLEdBQUdSLEtBQUssQ0FBQ1EsT0FOcEI7QUFBQSxJQU9JQyxNQUFNLEdBQUcsS0FQYjtBQUFBLElBUUlDLGNBQWMsR0FBRyxPQVJyQjtBQUFBLElBU0lDLENBQUMsR0FBRztBQUNGQyxFQUFBQSxPQUFPLEVBQUViLE9BQU8sQ0FBQyxnQkFBRCxDQURkO0FBRUZjLEVBQUFBLE1BQU0sRUFBRWQsT0FBTyxDQUFDLGlCQUFELENBRmI7QUFHRmUsRUFBQUEsSUFBSSxFQUFFZixPQUFPLENBQUMsYUFBRDtBQUhYLENBVFI7QUFBQSxJQWVFO0FBQ0E7QUFDQWdCLFVBQVUsR0FBRztBQUNYQyxFQUFBQSxJQUFJLEVBQUUsSUFESztBQUVYQyxFQUFBQSxJQUFJLEVBQUUsSUFGSztBQUdYQyxFQUFBQSxLQUFLLEVBQUU7QUFISSxDQWpCZjtBQUFBLElBdUJFO0FBQ0FDLFFBQVEsR0FBRyw2SEF4QmI7QUFBQSxJQXlCRTtBQUNBQyxNQUFNLEdBQUcs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R0FBd0JRLGNBQWMsQ0FBQ2YsSUFBZixDQUFvQixHQUFwQixDQUF4QjtBQUNEOztBQUVELFNBQU8sSUFBUDtBQUNELENBOUNEOztBQWdEQTNELE9BQU8sQ0FBQzJFLEVBQVIsR0FBYSxVQUFVQyxRQUFWLEVBQW9CO0FBQy9CLE1BQUlBLFFBQUosRUFBYztBQUNaLFdBQU8sS0FBSzlDLE1BQUwsQ0FBWThDLFFBQVosRUFBc0IvRCxNQUF0QixHQUErQixDQUF0QztBQUNEOztBQUNELFNBQU8sS0FBUDtBQUNELENBTEQiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgJCA9IHJlcXVpcmUoJy4uL3N0YXRpYycpLFxuICAgIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKSxcbiAgICBpc1RhZyA9IHV0aWxzLmlzVGFnLFxuICAgIGRvbUVhY2ggPSB1dGlscy5kb21FYWNoLFxuICAgIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXG4gICAgY2FtZWxDYXNlID0gdXRpbHMuY2FtZWxDYXNlLFxuICAgIGNzc0Nhc2UgPSB1dGlscy5jc3NDYXNlLFxuICAgIHJzcGFjZSA9IC9cXHMrLyxcbiAgICBkYXRhQXR0clByZWZpeCA9ICdkYXRhLScsXG4gICAgXyA9IHtcbiAgICAgIGZvckVhY2g6IHJlcXVpcmUoJ2xvZGFzaC9mb3JFYWNoJyksXG4gICAgICBleHRlbmQ6IHJlcXVpcmUoJ2xvZGFzaC9hc3NpZ25JbicpLFxuICAgICAgc29tZTogcmVxdWlyZSgnbG9kYXNoL3NvbWUnKVxuICAgIH0sXG5cbiAgLy8gTG9va3VwIHRhYmxlIGZvciBjb2VyY2luZyBzdHJpbmcgZGF0YS0qIGF0dHJpYnV0ZXMgdG8gdGhlaXIgY29ycmVzcG9uZGluZ1xuICAvLyBKYXZhU2NyaXB0IHByaW1pdGl2ZXNcbiAgcHJpbWl0aXZlcyA9IHtcbiAgICBudWxsOiBudWxsLFxuICAgIHRydWU6IHRydWUsXG4gICAgZmFsc2U6IGZhbHNlXG4gIH0sXG5cbiAgLy8gQXR0cmlidXRlcyB0aGF0IGFyZSBib29sZWFuc1xuICByYm9vbGVhbiA9IC9eKD86YXV0b2ZvY3VzfGF1dG9wbGF5fGFzeW5jfGNoZWNrZWR8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWR8c2VsZWN0ZWQpJC9pLFxuICAvLyBNYXRjaGVzIHN0cmluZ3MgdGhhdCBsb29rIGxpa2UgSlNPTiBvYmplY3RzIG9yIGFycmF5c1xuICByYnJhY2UgPSAvXig/Olxce1tcXHdcXFddKlxcfXxcXFtbXFx3XFxXXSpcXF0pJC87XG5cblxudmFyIGdldEF0dHIgPSBmdW5jdGlvbihlbGVtLCBuYW1lKSB7XG4gIGlmICghZWxlbSB8fCAhaXNUYWcoZWxlbSkpIHJldHVybjtcblxuICBpZiAoIWVsZW0uYXR0cmlicykge1xuICAgIGVsZW0uYXR0cmlicyA9IHt9O1xuICB9XG5cbiAgLy8gUmV0dXJuIHRoZSBlbnRpcmUgYXR0cmlicyBvYmplY3QgaWYgbm8gYXR0cmlidXRlIHNwZWNpZmllZFxuICBpZiAoIW5hbWUpIHtcbiAgICByZXR1cm4gZWxlbS5hdHRyaWJzO1xuICB9XG5cbiAgaWYgKGhhc093bi5jYWxsKGVsZW0uYXR0cmlicywgbmFtZSkpIHtcbiAgICAvLyBHZXQgdGhlIChkZWNvZGVkKSBhdHRyaWJ1dGVcbiAgICByZXR1cm4gcmJvb2xlYW4udGVzdChuYW1lKSA/IG5hbWUgOiBlbGVtLmF0dHJpYnNbbmFtZV07XG4gIH1cblxuICAvLyBNaW1pYyB0aGUgRE9NIGFuZCByZXR1cm4gdGV4dCBjb250ZW50IGFzIHZhbHVlIGZvciBgb3B0aW9uJ3NgXG4gIGlmIChlbGVtLm5hbWUgPT09ICdvcHRpb24nICYmIG5hbWUgPT09ICd2YWx1ZScpIHtcbiAgICByZXR1cm4gJC50ZXh0KGVsZW0uY2hpbGRyZW4pO1xuICB9XG5cbiAgLy8gTWltaWMgRE9NIHdpdGggZGVmYXVsdCB2YWx1ZSBmb3IgcmFkaW9zL2NoZWNrYm94ZXNcbiAgaWYgKGVsZW0ubmFtZSA9PT0gJ2lucHV0JyAmJlxuICAgICAgKGVsZW0uYXR0cmlicy50eXBlID09PSAncmFkaW8nIHx8IGVsZW0uYXR0cmlicy50eXBlID09PSAnY2hlY2tib3gnKSAmJlxuICAgICAgbmFtZSA9PT0gJ3ZhbHVlJykge1xuICAgIHJldHVybiAnb24nO1xuICB9XG59O1xuXG52YXIgc2V0QXR0ciA9IGZ1bmN0aW9uKGVsLCBuYW1lLCB2YWx1ZSkge1xuXG4gIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgIHJlbW92ZUF0dHJpYnV0ZShlbCwgbmFtZSk7XG4gIH0gZWxzZSB7XG4gICAgZWwuYXR0cmlic1tuYW1lXSA9IHZhbHVlKycnO1xuICB9XG59O1xuXG5leHBvcnRzLmF0dHIgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAvLyBTZXQgdGhlIHZhbHVlICh3aXRoIGF0dHIgbWFwIHN1cHBvcnQpXG4gIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcgfHwgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBkb21FYWNoKHRoaXMsIGZ1bmN0aW9uKGksIGVsKSB7XG4gICAgICAgIHNldEF0dHIoZWwsIG5hbWUsIHZhbHVlLmNhbGwoZWwsIGksIGVsLmF0dHJpYnNbbmFtZV0pKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihpLCBlbCkge1xuICAgICAgaWYgKCFpc1RhZyhlbCkpIHJldHVybjtcblxuICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuICAgICAgICBfLmZvckVhY2gobmFtZSwgZnVuY3Rpb24ob2JqVmFsdWUsIG9iak5hbWUpIHtcbiAgICAgICAgICBzZXRBdHRyKGVsLCBvYmpOYW1lLCBvYmpWYWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0QXR0cihlbCwgbmFtZSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIGdldEF0dHIodGhpc1swXSwgbmFtZSk7XG59O1xuXG52YXIgZ2V0UHJvcCA9IGZ1bmN0aW9uIChlbCwgbmFtZSkge1xuICBpZiAoIWVsIHx8ICFpc1RhZyhlbCkpIHJldHVybjtcblxuICByZXR1cm4gaGFzT3duLmNhbGwoZWwsIG5hbWUpXG4gICAgICA/IGVsW25hbWVdXG4gICAgICA6IHJib29sZWFuLnRlc3QobmFtZSlcbiAgICAgICAgICA/IGdldEF0dHIoZWwsIG5hbWUpICE9PSB1bmRlZmluZWRcbiAgICAgICAgICA6IGdldEF0dHIoZWwsIG5hbWUpO1xufTtcblxudmFyIHNldFByb3AgPSBmdW5jdGlvbiAoZWwsIG5hbWUsIHZhbHVlKSB7XG4gIGVsW25hbWVdID0gcmJvb2xlYW4udGVzdChuYW1lKSA/ICEhdmFsdWUgOiB2YWx1ZTtcbn07XG5cbmV4cG9ydHMucHJvcCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICB2YXIgaSA9IDAsXG4gICAgICBwcm9wZXJ0eTtcblxuICBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnICYmIHZhbHVlID09PSB1bmRlZmluZWQpIHtcblxuICAgIHN3aXRjaCAobmFtZSkge1xuICAgICAgY2FzZSAnc3R5bGUnOlxuICAgICAgICBwcm9wZXJ0eSA9IHRoaXMuY3NzKCk7XG5cbiAgICAgICAgXy5mb3JFYWNoKHByb3BlcnR5LCBmdW5jdGlvbiAodiwgcCkge1xuICAgICAgICAgIHByb3BlcnR5W2krK10gPSBwO1xuICAgICAgICB9KTtcblxuICAgICAgICBwcm9wZXJ0eS5sZW5ndGggPSBpO1xuXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndGFnTmFtZSc6XG4gICAgICBjYXNlICdub2RlTmFtZSc6XG4gICAgICAgIHByb3BlcnR5ID0gdGhpc1swXS5uYW1lLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcHJvcGVydHkgPSBnZXRQcm9wKHRoaXNbMF0sIG5hbWUpO1xuICAgIH1cblxuICAgIHJldHVybiBwcm9wZXJ0eTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcgfHwgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIGRvbUVhY2godGhpcywgZnVuY3Rpb24oaiwgZWwpIHtcbiAgICAgICAgc2V0UHJvcChlbCwgbmFtZSwgdmFsdWUuY2FsbChlbCwgaiwgZ2V0UHJvcChlbCwgbmFtZSkpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBkb21FYWNoKHRoaXMsIGZ1bmN0aW9uKF9fLCBlbCkge1xuICAgICAgaWYgKCFpc1RhZyhlbCkpIHJldHVybjtcblxuICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuXG4gICAgICAgIF8uZm9yRWFjaChuYW1lLCBmdW5jdGlvbih2YWwsIGtleSkge1xuICAgICAgICAgIHNldFByb3AoZWwsIGtleSwgdmFsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFByb3AoZWwsIG5hbWUsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICB9XG59O1xuXG52YXIgc2V0RGF0YSA9IGZ1bmN0aW9uKGVsLCBuYW1lLCB2YWx1ZSkge1xuICBpZiAoIWVsLmRhdGEpIHtcbiAgICBlbC5kYXRhID0ge307XG4gIH1cblxuICBpZiAodHlwZW9mIG5hbWUgPT09ICdvYmplY3QnKSByZXR1cm4gXy5leHRlbmQoZWwuZGF0YSwgbmFtZSk7XG4gIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGVsLmRhdGFbbmFtZV0gPSB2YWx1ZTtcbiAgfVxufTtcblxuLy8gUmVhZCB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZSBmcm9tIHRoZSBlcXVpdmFsZW50IEhUTUw1IGBkYXRhLSpgIGF0dHJpYnV0ZSxcbi8vIGFuZCAoaWYgcHJlc2VudCkgY2FjaGUgdGhlIHZhbHVlIGluIHRoZSBub2RlJ3MgaW50ZXJuYWwgZGF0YSBzdG9yZS4gSWYgbm9cbi8vIGF0dHJpYnV0ZSBuYW1lIGlzIHNwZWNpZmllZCwgcmVhZCAqYWxsKiBIVE1MNSBgZGF0YS0qYCBhdHRyaWJ1dGVzIGluIHRoaXNcbi8vIG1hbm5lci5cbnZhciByZWFkRGF0YSA9IGZ1bmN0aW9uKGVsLCBuYW1lKSB7XG4gIHZhciByZWFkQWxsID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMTtcbiAgdmFyIGRvbU5hbWVzLCBkb21OYW1lLCBqc05hbWVzLCBqc05hbWUsIHZhbHVlLCBpZHgsIGxlbmd0aDtcblxuICBpZiAocmVhZEFsbCkge1xuICAgIGRvbU5hbWVzID0gT2JqZWN0LmtleXMoZWwuYXR0cmlicykuZmlsdGVyKGZ1bmN0aW9uKGF0dHJOYW1lKSB7XG4gICAgICByZXR1cm4gYXR0ck5hbWUuc2xpY2UoMCwgZGF0YUF0dHJQcmVmaXgubGVuZ3RoKSA9PT0gZGF0YUF0dHJQcmVmaXg7XG4gICAgfSk7XG4gICAganNOYW1lcyA9IGRvbU5hbWVzLm1hcChmdW5jdGlvbihfZG9tTmFtZSkge1xuICAgICAgcmV0dXJuIGNhbWVsQ2FzZShfZG9tTmFtZS5zbGljZShkYXRhQXR0clByZWZpeC5sZW5ndGgpKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBkb21OYW1lcyA9IFtkYXRhQXR0clByZWZpeCArIGNzc0Nhc2UobmFtZSldO1xuICAgIGpzTmFtZXMgPSBbbmFtZV07XG4gIH1cblxuICBmb3IgKGlkeCA9IDAsIGxlbmd0aCA9IGRvbU5hbWVzLmxlbmd0aDsgaWR4IDwgbGVuZ3RoOyArK2lkeCkge1xuICAgIGRvbU5hbWUgPSBkb21OYW1lc1tpZHhdO1xuICAgIGpzTmFtZSA9IGpzTmFtZXNbaWR4XTtcbiAgICBpZiAoaGFzT3duLmNhbGwoZWwuYXR0cmlicywgZG9tTmFtZSkpIHtcbiAgICAgIHZhbHVlID0gZWwuYXR0cmlic1tkb21OYW1lXTtcblxuICAgICAgaWYgKGhhc093bi5jYWxsKHByaW1pdGl2ZXMsIHZhbHVlKSkge1xuICAgICAgICB2YWx1ZSA9IHByaW1pdGl2ZXNbdmFsdWVdO1xuICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gU3RyaW5nKE51bWJlcih2YWx1ZSkpKSB7XG4gICAgICAgIHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAocmJyYWNlLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgfSBjYXRjaChlKXsgfVxuICAgICAgfVxuXG4gICAgICBlbC5kYXRhW2pzTmFtZV0gPSB2YWx1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVhZEFsbCA/IGVsLmRhdGEgOiB2YWx1ZTtcbn07XG5cbmV4cG9ydHMuZGF0YSA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIHZhciBlbGVtID0gdGhpc1swXTtcblxuICBpZiAoIWVsZW0gfHwgIWlzVGFnKGVsZW0pKSByZXR1cm47XG5cbiAgaWYgKCFlbGVtLmRhdGEpIHtcbiAgICBlbGVtLmRhdGEgPSB7fTtcbiAgfVxuXG4gIC8vIFJldHVybiB0aGUgZW50aXJlIGRhdGEgb2JqZWN0IGlmIG5vIGRhdGEgc3BlY2lmaWVkXG4gIGlmICghbmFtZSkge1xuICAgIHJldHVybiByZWFkRGF0YShlbGVtKTtcbiAgfVxuXG4gIC8vIFNldCB0aGUgdmFsdWUgKHdpdGggYXR0ciBtYXAgc3VwcG9ydClcbiAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0JyB8fCB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihpLCBlbCkge1xuICAgICAgc2V0RGF0YShlbCwgbmFtZSwgdmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9IGVsc2UgaWYgKGhhc093bi5jYWxsKGVsZW0uZGF0YSwgbmFtZSkpIHtcbiAgICByZXR1cm4gZWxlbS5kYXRhW25hbWVdO1xuICB9XG5cbiAgcmV0dXJuIHJlYWREYXRhKGVsZW0sIG5hbWUpO1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIHZhbHVlIG9mIGFuIGVsZW1lbnRcbiAqL1xuXG5leHBvcnRzLnZhbCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHZhciBxdWVyeWluZyA9IGFyZ3VtZW50cy5sZW5ndGggPT09IDAsXG4gICAgICBlbGVtZW50ID0gdGhpc1swXTtcblxuICBpZighZWxlbWVudCkgcmV0dXJuO1xuXG4gIHN3aXRjaCAoZWxlbWVudC5uYW1lKSB7XG4gICAgY2FzZSAndGV4dGFyZWEnOlxuICAgICAgcmV0dXJuIHRoaXMudGV4dCh2YWx1ZSk7XG4gICAgY2FzZSAnaW5wdXQnOlxuICAgICAgc3dpdGNoICh0aGlzLmF0dHIoJ3R5cGUnKSkge1xuICAgICAgICBjYXNlICdyYWRpbyc6XG4gICAgICAgICAgaWYgKHF1ZXJ5aW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyKCd2YWx1ZScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmF0dHIoJ3ZhbHVlJywgdmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiB0aGlzLmF0dHIoJ3ZhbHVlJywgdmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIGNhc2UgJ3NlbGVjdCc6XG4gICAgICB2YXIgb3B0aW9uID0gdGhpcy5maW5kKCdvcHRpb246c2VsZWN0ZWQnKSxcbiAgICAgICAgICByZXR1cm5WYWx1ZTtcbiAgICAgIGlmIChvcHRpb24gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIGlmICghcXVlcnlpbmcpIHtcbiAgICAgICAgaWYgKCFoYXNPd24uY2FsbCh0aGlzLmF0dHIoKSwgJ211bHRpcGxlJykgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPSAnb2JqZWN0Jykge1xuICAgICAgICAgIHZhbHVlID0gW3ZhbHVlXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZpbmQoJ29wdGlvbicpLnJlbW92ZUF0dHIoJ3NlbGVjdGVkJyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLmZpbmQoJ29wdGlvblt2YWx1ZT1cIicgKyB2YWx1ZVtpXSArICdcIl0nKS5hdHRyKCdzZWxlY3RlZCcsICcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIHJldHVyblZhbHVlID0gb3B0aW9uLmF0dHIoJ3ZhbHVlJyk7XG4gICAgICBpZiAoaGFzT3duLmNhbGwodGhpcy5hdHRyKCksICdtdWx0aXBsZScpKSB7XG4gICAgICAgIHJldHVyblZhbHVlID0gW107XG4gICAgICAgIGRvbUVhY2gob3B0aW9uLCBmdW5jdGlvbihfXywgZWwpIHtcbiAgICAgICAgICByZXR1cm5WYWx1ZS5wdXNoKGdldEF0dHIoZWwsICd2YWx1ZScpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XG4gICAgY2FzZSAnb3B0aW9uJzpcbiAgICAgIGlmICghcXVlcnlpbmcpIHtcbiAgICAgICAgdGhpcy5hdHRyKCd2YWx1ZScsIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5hdHRyKCd2YWx1ZScpO1xuICB9XG59O1xuXG4vKipcbiAqIFJlbW92ZSBhbiBhdHRyaWJ1dGVcbiAqL1xuXG52YXIgcmVtb3ZlQXR0cmlidXRlID0gZnVuY3Rpb24oZWxlbSwgbmFtZSkge1xuICBpZiAoIWVsZW0uYXR0cmlicyB8fCAhaGFzT3duLmNhbGwoZWxlbS5hdHRyaWJzLCBuYW1lKSlcbiAgICByZXR1cm47XG5cbiAgZGVsZXRlIGVsZW0uYXR0cmlic1tuYW1lXTtcbn07XG5cblxuZXhwb3J0cy5yZW1vdmVBdHRyID0gZnVuY3Rpb24obmFtZSkge1xuICBkb21FYWNoKHRoaXMsIGZ1bmN0aW9uKGksIGVsZW0pIHtcbiAgICByZW1vdmVBdHRyaWJ1dGUoZWxlbSwgbmFtZSk7XG4gIH0pO1xuXG4gIHJldHVybiB0aGlzO1xufTtcblxuZXhwb3J0cy5oYXNDbGFzcyA9IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICByZXR1cm4gXy5zb21lKHRoaXMsIGZ1bmN0aW9uKGVsZW0pIHtcbiAgICB2YXIgYXR0cnMgPSBlbGVtLmF0dHJpYnMsXG4gICAgICAgIGNsYXp6ID0gYXR0cnMgJiYgYXR0cnNbJ2NsYXNzJ10sXG4gICAgICAgIGlkeCA9IC0xLFxuICAgICAgICBlbmQ7XG5cbiAgICBpZiAoY2xhenogJiYgY2xhc3NOYW1lLmxlbmd0aCkge1xuICAgICAgd2hpbGUgKChpZHggPSBjbGF6ei5pbmRleE9mKGNsYXNzTmFtZSwgaWR4KzEpKSA+IC0xKSB7XG4gICAgICAgIGVuZCA9IGlkeCArIGNsYXNzTmFtZS5sZW5ndGg7XG5cbiAgICAgICAgaWYgKChpZHggPT09IDAgfHwgcnNwYWNlLnRlc3QoY2xhenpbaWR4LTFdKSlcbiAgICAgICAgICAgICYmIChlbmQgPT09IGNsYXp6Lmxlbmd0aCB8fCByc3BhY2UudGVzdChjbGF6eltlbmRdKSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5leHBvcnRzLmFkZENsYXNzID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgLy8gU3VwcG9ydCBmdW5jdGlvbnNcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBkb21FYWNoKHRoaXMsIGZ1bmN0aW9uKGksIGVsKSB7XG4gICAgICB2YXIgY2xhc3NOYW1lID0gZWwuYXR0cmlic1snY2xhc3MnXSB8fCAnJztcbiAgICAgIGV4cG9ydHMuYWRkQ2xhc3MuY2FsbChbZWxdLCB2YWx1ZS5jYWxsKGVsLCBpLCBjbGFzc05hbWUpKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFJldHVybiBpZiBubyB2YWx1ZSBvciBub3QgYSBzdHJpbmcgb3IgZnVuY3Rpb25cbiAgaWYgKCF2YWx1ZSB8fCB0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSByZXR1cm4gdGhpcztcblxuICB2YXIgY2xhc3NOYW1lcyA9IHZhbHVlLnNwbGl0KHJzcGFjZSksXG4gICAgICBudW1FbGVtZW50cyA9IHRoaXMubGVuZ3RoO1xuXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1FbGVtZW50czsgaSsrKSB7XG4gICAgLy8gSWYgc2VsZWN0ZWQgZWxlbWVudCBpc24ndCBhIHRhZywgbW92ZSBvblxuICAgIGlmICghaXNUYWcodGhpc1tpXSkpIGNvbnRpbnVlO1xuXG4gICAgLy8gSWYgd2UgZG9uJ3QgYWxyZWFkeSBoYXZlIGNsYXNzZXNcbiAgICB2YXIgY2xhc3NOYW1lID0gZ2V0QXR0cih0aGlzW2ldLCAnY2xhc3MnKSxcbiAgICAgICAgbnVtQ2xhc3NlcyxcbiAgICAgICAgc2V0Q2xhc3M7XG5cbiAgICBpZiAoIWNsYXNzTmFtZSkge1xuICAgICAgc2V0QXR0cih0aGlzW2ldLCAnY2xhc3MnLCBjbGFzc05hbWVzLmpvaW4oJyAnKS50cmltKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRDbGFzcyA9ICcgJyArIGNsYXNzTmFtZSArICcgJztcbiAgICAgIG51bUNsYXNzZXMgPSBjbGFzc05hbWVzLmxlbmd0aDtcblxuICAgICAgLy8gQ2hlY2sgaWYgY2xhc3MgYWxyZWFkeSBleGlzdHNcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtQ2xhc3NlczsgaisrKSB7XG4gICAgICAgIHZhciBhcHBlbmRDbGFzcyA9IGNsYXNzTmFtZXNbal0gKyAnICc7XG4gICAgICAgIGlmIChzZXRDbGFzcy5pbmRleE9mKCcgJyArIGFwcGVuZENsYXNzKSA8IDApXG4gICAgICAgICAgc2V0Q2xhc3MgKz0gYXBwZW5kQ2xhc3M7XG4gICAgICB9XG5cbiAgICAgIHNldEF0dHIodGhpc1tpXSwgJ2NsYXNzJywgc2V0Q2xhc3MudHJpbSgpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbnZhciBzcGxpdENsYXNzID0gZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gIHJldHVybiBjbGFzc05hbWUgPyBjbGFzc05hbWUudHJpbSgpLnNwbGl0KHJzcGFjZSkgOiBbXTtcbn07XG5cbmV4cG9ydHMucmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgY2xhc3NlcyxcbiAgICAgIG51bUNsYXNzZXMsXG4gICAgICByZW1vdmVBbGw7XG5cbiAgLy8gSGFuZGxlIGlmIHZhbHVlIGlzIGEgZnVuY3Rpb25cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBkb21FYWNoKHRoaXMsIGZ1bmN0aW9uKGksIGVsKSB7XG4gICAgICBleHBvcnRzLnJlbW92ZUNsYXNzLmNhbGwoXG4gICAgICAgIFtlbF0sIHZhbHVlLmNhbGwoZWwsIGksIGVsLmF0dHJpYnNbJ2NsYXNzJ10gfHwgJycpXG4gICAgICApO1xuICAgIH0pO1xuICB9XG5cbiAgY2xhc3NlcyA9IHNwbGl0Q2xhc3ModmFsdWUpO1xuICBudW1DbGFzc2VzID0gY2xhc3Nlcy5sZW5ndGg7XG4gIHJlbW92ZUFsbCA9IGFyZ3VtZW50cy5sZW5ndGggPT09IDA7XG5cbiAgcmV0dXJuIGRvbUVhY2godGhpcywgZnVuY3Rpb24oaSwgZWwpIHtcbiAgICBpZiAoIWlzVGFnKGVsKSkgcmV0dXJuO1xuXG4gICAgaWYgKHJlbW92ZUFsbCkge1xuICAgICAgLy8gU2hvcnQgY2lyY3VpdCB0aGUgcmVtb3ZlIGFsbCBjYXNlIGFzIHRoaXMgaXMgdGhlIG5pY2Ugb25lXG4gICAgICBlbC5hdHRyaWJzLmNsYXNzID0gJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBlbENsYXNzZXMgPSBzcGxpdENsYXNzKGVsLmF0dHJpYnMuY2xhc3MpLFxuICAgICAgICAgIGluZGV4LFxuICAgICAgICAgIGNoYW5nZWQ7XG5cbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtQ2xhc3NlczsgaisrKSB7XG4gICAgICAgIGluZGV4ID0gZWxDbGFzc2VzLmluZGV4T2YoY2xhc3Nlc1tqXSk7XG5cbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICBlbENsYXNzZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcblxuICAgICAgICAgIC8vIFdlIGhhdmUgdG8gZG8gYW5vdGhlciBwYXNzIHRvIGVuc3VyZSB0aGF0IHRoZXJlIGFyZSBub3QgZHVwbGljYXRlXG4gICAgICAgICAgLy8gY2xhc3NlcyBsaXN0ZWRcbiAgICAgICAgICBqLS07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgIGVsLmF0dHJpYnMuY2xhc3MgPSBlbENsYXNzZXMuam9pbignICcpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5leHBvcnRzLnRvZ2dsZUNsYXNzID0gZnVuY3Rpb24odmFsdWUsIHN0YXRlVmFsKSB7XG4gIC8vIFN1cHBvcnQgZnVuY3Rpb25zXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihpLCBlbCkge1xuICAgICAgZXhwb3J0cy50b2dnbGVDbGFzcy5jYWxsKFxuICAgICAgICBbZWxdLFxuICAgICAgICB2YWx1ZS5jYWxsKGVsLCBpLCBlbC5hdHRyaWJzWydjbGFzcyddIHx8ICcnLCBzdGF0ZVZhbCksXG4gICAgICAgIHN0YXRlVmFsXG4gICAgICApO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gUmV0dXJuIGlmIG5vIHZhbHVlIG9yIG5vdCBhIHN0cmluZyBvciBmdW5jdGlvblxuICBpZiAoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHJldHVybiB0aGlzO1xuXG4gIHZhciBjbGFzc05hbWVzID0gdmFsdWUuc3BsaXQocnNwYWNlKSxcbiAgICBudW1DbGFzc2VzID0gY2xhc3NOYW1lcy5sZW5ndGgsXG4gICAgc3RhdGUgPSB0eXBlb2Ygc3RhdGVWYWwgPT09ICdib29sZWFuJyA/IHN0YXRlVmFsID8gMSA6IC0xIDogMCxcbiAgICBudW1FbGVtZW50cyA9IHRoaXMubGVuZ3RoLFxuICAgIGVsZW1lbnRDbGFzc2VzLFxuICAgIGluZGV4O1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRWxlbWVudHM7IGkrKykge1xuICAgIC8vIElmIHNlbGVjdGVkIGVsZW1lbnQgaXNuJ3QgYSB0YWcsIG1vdmUgb25cbiAgICBpZiAoIWlzVGFnKHRoaXNbaV0pKSBjb250aW51ZTtcblxuICAgIGVsZW1lbnRDbGFzc2VzID0gc3BsaXRDbGFzcyh0aGlzW2ldLmF0dHJpYnMuY2xhc3MpO1xuXG4gICAgLy8gQ2hlY2sgaWYgY2xhc3MgYWxyZWFkeSBleGlzdHNcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IG51bUNsYXNzZXM7IGorKykge1xuICAgICAgLy8gQ2hlY2sgaWYgdGhlIGNsYXNzIG5hbWUgaXMgY3VycmVudGx5IGRlZmluZWRcbiAgICAgIGluZGV4ID0gZWxlbWVudENsYXNzZXMuaW5kZXhPZihjbGFzc05hbWVzW2pdKTtcblxuICAgICAgLy8gQWRkIGlmIHN0YXRlVmFsdWUgPT09IHRydWUgb3Igd2UgYXJlIHRvZ2dsaW5nIGFuZCB0aGVyZSBpcyBubyB2YWx1ZVxuICAgICAgaWYgKHN0YXRlID49IDAgJiYgaW5kZXggPCAwKSB7XG4gICAgICAgIGVsZW1lbnRDbGFzc2VzLnB1c2goY2xhc3NOYW1lc1tqXSk7XG4gICAgICB9IGVsc2UgaWYgKHN0YXRlIDw9IDAgJiYgaW5kZXggPj0gMCkge1xuICAgICAgICAvLyBPdGhlcndpc2UgcmVtb3ZlIGJ1dCBvbmx5IGlmIHRoZSBpdGVtIGV4aXN0c1xuICAgICAgICBlbGVtZW50Q2xhc3Nlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXNbaV0uYXR0cmlicy5jbGFzcyA9IGVsZW1lbnRDbGFzc2VzLmpvaW4oJyAnKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuZXhwb3J0cy5pcyA9IGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICBpZiAoc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gdGhpcy5maWx0ZXIoc2VsZWN0b3IpLmxlbmd0aCA+IDA7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcbiJdfQ==